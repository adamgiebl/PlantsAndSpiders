parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"JB82":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canvasCenter=exports.groundY=exports.groundHeight=exports.groundPositionX=exports.maskCtx=exports.mask=exports.ctx=exports.canvas=void 0;const t=document.querySelector("canvas");exports.canvas=t;const e=t.getContext("2d");exports.ctx=e,e.font="30px Anton",t.width=innerWidth,t.height=innerHeight;const o=document.createElement("canvas");exports.mask=o;const n=o.getContext("2d");exports.maskCtx=n,o.width=innerWidth,o.height=innerHeight;const s=0;exports.groundPositionX=0;const r=15;exports.groundHeight=15;let i=t.height-15;exports.groundY=i;const x=()=>{window.location.reload()},d={x:t.width/2,y:t.height/2};exports.canvasCenter=d,window.addEventListener("resize",x);
},{}],"q2ym":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class e{constructor(){this.keyStates=new Map,this.keyMap=new Map}addMapping(e,t){this.keyMap.set(e,t)}handleEvent(e){const{code:t}=e;if(!this.keyMap.has(t))return;e.preventDefault();const s="keydown"===e.type;this.keyStates.get(t)!==s&&(this.keyStates.set(t,s),this.keyMap.get(t)(s))}listenTo(e){["keydown","keyup"].forEach(t=>{e.addEventListener(t,e=>{this.handleEvent(e)})})}}exports.default=e;
},{}],"gFLk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setUpMouse=exports.setUpKeyboard=void 0;var e=n(require("./KeyboardHandler")),t=require("/src/shared/canvas");function n(e){return e&&e.__esModule?e:{default:e}}const r=t=>{const n=new e.default;n.addMapping("KeyD",e=>{t.direction.right=e}),n.addMapping("KeyA",e=>{t.direction.left=e}),n.addMapping("Space",e=>{t.direction.jumping=e}),n.listenTo(window)};exports.setUpKeyboard=r;const o=e=>{t.canvas.addEventListener("mousemove",({clientX:t,clientY:n})=>{e.rotate(t,n)}),t.canvas.addEventListener("click",t=>{e.onClick()})};exports.setUpMouse=o;
},{"./KeyboardHandler":"q2ym","/src/shared/canvas":"JB82"}],"LVkv":[function(require,module,exports) {
module.exports="ShotgunQuieter.22a5d387.mp3";
},{}],"LJYD":[function(require,module,exports) {
module.exports="Splash.31602965.mp3";
},{}],"IIEz":[function(require,module,exports) {
module.exports="glass.8efdaea5.mp3";
},{}],"PvUO":[function(require,module,exports) {
module.exports="reggae.1642113d.mp3";
},{}],"Us6K":[function(require,module,exports) {
module.exports="seed.562cd4f6.mp3";
},{}],"zD4a":[function(require,module,exports) {
module.exports="plant.9ceb7883.mp3";
},{}],"Zxl9":[function(require,module,exports) {
module.exports="spiderBite.e07fb5c6.mp3";
},{}],"EWf2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.audioPlayer=exports.AudioPlayer=void 0;var e=s(require("/static/sounds/ShotgunQuieter.mp3")),t=s(require("/static/sounds/Splash.mp3")),i=s(require("/static/sounds/glass.mp3")),o=s(require("/static/sounds/reggae.mp3")),d=s(require("/static/sounds/seed.mp3")),a=s(require("/static/sounds/plant.mp3")),u=s(require("/static/sounds/spiderBite.mp3"));function s(e){return e&&e.__esModule?e:{default:e}}class n{constructor(){this.audioContext=new AudioContext,this.audioBuffers=new Map,this.muted=!1,this.gainNodeFx=this.audioContext.createGain(),this.gainNodeMusic=this.audioContext.createGain()}loadAudio(e){return fetch(e).then(e=>e.arrayBuffer()).then(e=>this.audioContext.decodeAudioData(e))}addAudio(e,t){this.audioBuffers.set(e,t)}playAudio(e){const t=this.audioContext.createBufferSource();t.connect(this.gainNodeFx),this.gainNodeFx.connect(this.audioContext.destination),t.buffer=this.audioBuffers.get(e),t.start(0)}playMusic(e){const t=this.audioContext.createBufferSource();t.connect(this.gainNodeMusic),this.gainNodeMusic.connect(this.audioContext.destination),t.buffer=this.audioBuffers.get(e),t.loop=!0,t.start(0)}changeVolume(e,t){"MUSIC"===e?this.gainNodeMusic.gain.value=t:"FX"===e&&(this.gainNodeFx.gain.value=t)}async loadAllSounds(){await Promise.all([r.loadAudio(e.default),r.loadAudio(t.default),r.loadAudio(i.default),r.loadAudio(o.default),r.loadAudio(d.default),r.loadAudio(a.default),r.loadAudio(u.default)]).then(([e,t,i,o,d,a,u])=>{r.addAudio("gunshot",e),r.addAudio("splash",t),r.addAudio("glass",i),r.addAudio("music",o),r.addAudio("seed",d),r.addAudio("plant",a),r.addAudio("spiderBite",u)})}}exports.AudioPlayer=n;const r=new n;exports.audioPlayer=r;
},{"/static/sounds/ShotgunQuieter.mp3":"LVkv","/static/sounds/Splash.mp3":"LJYD","/static/sounds/glass.mp3":"IIEz","/static/sounds/reggae.mp3":"PvUO","/static/sounds/seed.mp3":"Us6K","/static/sounds/plant.mp3":"zD4a","/static/sounds/spiderBite.mp3":"Zxl9"}],"vUgb":[function(require,module,exports) {
"use strict";function e(e){return new Promise(n=>{const t=new Image;t.addEventListener("load",()=>{n(t)}),t.src=e})}function n(e){return fetch(`./manifests/${e}.json`).then(e=>e.json())}function t(e){const n=new Map;return e.forEach(e=>{const t=new Map;e.frames.forEach(e=>{t.set(e.name,e.rect)}),n.set(e.name,t)}),n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadImage=e,exports.loadManifest=n,exports.loadAnimations=t;
},{}],"g3lD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadCharacter=exports.Character=void 0;var i=require("/src/shared/canvas"),t=require("../input"),e=require("../AudioPlayer"),s=require("./loaders");class h{constructor(t){this.manifest=t,this.direction={left:!1,right:!1,jumping:!1},this.isOnGround=!0,this.deltaX=0,this.deltaY=0,this.angle=0,this.velocityX=6,this.velocityY=0,this.gravity=.6,this.flip=!1,this.shot=!1,this.distance=0,this.ready=!0,this.streak=0,this.highestStreak=0,this.lowerBody={...this.manifest.lowerBody,runningAnimation:this.manifest.animations.get("running"),jumpingAnimation:this.manifest.animations.get("jumping")},this.upperBody={...this.manifest.upperBody,x:this.x-30,y:this.y-this.lowerBody.height+70},this.x=0,this.y=i.canvas.height-i.groundHeight-this.lowerBody.height+5,this.flashAnimation={active:!1,duration:3,frame:0,image:this.manifest.flashImage},this.shootingAnimation={active:!1,duration:4,frame:0,size:5},this.setUp()}draw(i){this.upperBody={...this.upperBody,rotationPoint:{x:this.x+this.lowerBody.width/2,y:this.y+25},x:this.x-25,y:this.y-this.lowerBody.height+(this.flip?160:100)},i.strokeStyle="red",this.getFrame(i,`walk-${Math.floor(this.distance/20)%this.lowerBody.runningAnimation.size}`),i.translate(this.upperBody.rotationPoint.x,this.upperBody.rotationPoint.y),i.rotate(this.angle),i.translate(-this.upperBody.rotationPoint.x,-this.upperBody.rotationPoint.y),i.strokeStyle="limegreen",this.runShootingAnimation(),i.drawImage(this.flip?this.upperBody.imageFlipped:this.upperBody.image,this.upperBody.x,this.upperBody.y,this.upperBody.width,this.upperBody.height),i.setTransform(1,0,0,1,0,0),i.fillStyle="blue"}move(){this.velocityY+=this.gravity,this.y+=this.velocityY,this.y+this.lowerBody.height>=i.groundY&&(this.y=i.groundY-this.lowerBody.height,this.isOnGround=!0,this.velocityY=0),this.direction.left?this.x>0&&(this.x-=this.velocityX,this.distance+=this.velocityX):this.direction.right?this.x<i.canvas.width-this.upperBody.width&&(this.x+=this.velocityX,this.distance+=this.velocityX):this.ready&&(this.distance=0),this.direction.jumping&&this.isOnGround&&(this.velocityY=-12,this.isOnGround=!1)}getFrame(i,t){if(this.isOnGround){const e=this.lowerBody.runningAnimation.get(t);i.drawImage(this.lowerBody.spriteSheet,e.x,this.flip?e.y+e.height:e.y,e.width,e.height,this.x,this.y,this.lowerBody.width,this.lowerBody.height)}else{const t=this.lowerBody.jumpingAnimation.get("jump-0");i.drawImage(this.lowerBody.spriteSheet,t.x,this.flip?t.y+t.height:t.y,t.width,t.height,this.x,this.y,this.lowerBody.width,this.lowerBody.height)}}drawFlash(t){1==this.flashAnimation.active&&(this.flashAnimation.frame>=this.flashAnimation.duration?(this.flashAnimation.frame=0,this.flashAnimation.active=!1):(this.flashAnimation.frame++,t.fillStyle="rgba(249, 191, 0, 0.1)",t.fillRect(0,0,i.canvas.width,i.canvas.height),t.translate(this.upperBody.rotationPoint.x,this.upperBody.rotationPoint.y),t.rotate(this.angle),t.translate(-this.upperBody.rotationPoint.x,-this.upperBody.rotationPoint.y),t.strokeStyle="limegreen",t.drawImage(this.flashAnimation.image,this.upperBody.x+this.upperBody.width,this.upperBody.y+(this.flip?0:100),this.upperBody.width,this.upperBody.height/2),t.setTransform(1,0,0,1,0,0)))}runShootingAnimation(){this.shootingAnimation.active&&(this.shootingAnimation.frame>=this.shootingAnimation.duration?(this.shootingAnimation.frame=0,this.shootingAnimation.active=!1):(this.shootingAnimation.frame++,this.upperBody.x=this.upperBody.x-this.shootingAnimation.size*this.shootingAnimation.frame))}rotate(i,t){this.angle=Math.atan2(this.y+this.upperBody.height/2-t,this.x+this.upperBody.width/2-i)+Math.PI,this.angle>1.5&&this.angle<4.7?this.flip=!0:this.flip=!1}onClick(){e.audioPlayer.playAudio("gunshot"),this.flashAnimation.active=!0,this.shootingAnimation.active=!0}setUp(){(0,t.setUpKeyboard)(this),(0,t.setUpMouse)(this)}}exports.Character=h;const o=async()=>{const i=await(0,s.loadManifest)("character");return i.lowerBody={...i.lowerBody,spriteSheet:await(0,s.loadImage)(i.lowerBody.spriteSheetURL)},i.upperBody={...i.upperBody,image:await(0,s.loadImage)(i.upperBody.imageURL),imageFlipped:await(0,s.loadImage)(i.upperBody.flippedImageURL)},i.flashImage=await(0,s.loadImage)(i.flashImageURL),i.animations=(0,s.loadAnimations)(i.animationsToBeLoaded),new h(i)};exports.loadCharacter=o;
},{"/src/shared/canvas":"JB82","../input":"gFLk","../AudioPlayer":"EWf2","./loaders":"vUgb"}],"kGKP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadScene=exports.Scene=void 0;var e=require("/src/shared/canvas"),a=require("/src/classes/loaders");class s{constructor(e){this.manifest=e}draw(a){a.drawImage(this.manifest.image,0,0,e.canvas.width,e.canvas.height)}}exports.Scene=s;const r=async()=>{const e=await(0,a.loadManifest)("scene");return e.image=await(0,a.loadImage)(e.mainImageURL),new s(e)};exports.loadScene=r;
},{"/src/shared/canvas":"JB82","/src/classes/loaders":"vUgb"}],"OEJg":[function(require,module,exports) {
"use strict";function t(t){return Math.floor(Math.random()*Math.floor(t))}function o(t,o){return Math.floor(Math.random()*(o-t+1)+t)}function e(t,o){return t.x<o.x+o.width&&t.x+t.width>o.x&&t.y<o.y+o.height&&t.y+t.height>o.y}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRandomInt=t,exports.randomIntFromRange=o,exports.checkCollision=e;
},{}],"SACW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadSpiderFactory=exports.SpiderFactory=exports.Spider=void 0;var t=require("/src/shared/canvas"),i=require("/src/shared/helpers"),s=require("../AudioPlayer"),e=require("./loaders");class a{constructor(t){const{destination:i,position:s,width:e,height:a,speed:h}=t;this.manifest=t,this.height=e,this.width=a,this.x=s.x,this.y=s.y,this.isShot=!1,this.hasKilledAPlant=!1,this.killer={},this.deltaX=i.x-this.x,this.deltaY=i.y-this.y,this.angle=Math.atan2(this.deltaY,this.deltaX),this.splashAngle=0,this.velocityX=1*Math.cos(this.angle),this.velocityY=1*Math.sin(this.angle),this.direction=this.angle-Math.PI/2,this.distance=0,this.speed=h,this.points={shown:!1,value:Math.floor(1e3/this.width),y:this.y,speed:2,multiplier:1}}draw(t){this.isShot||this.hasKilledAPlant?this.hasKilledAPlant||(t.translate(this.x+this.width/2,this.y+this.height/2),t.rotate(-this.splashAngle+Math.PI),t.translate(-this.x-this.width/2,-this.y-this.height/2),t.drawImage(this.manifest.splashImage,this.x-10,this.y-this.height,this.width+20,2*this.height),t.setTransform(1,0,0,1,0,0),this.points.shown&&this.drawPoints(t)):(this.distance+=2,t.translate(this.x+this.width/2,this.y+this.height/2),t.rotate(this.direction),t.translate(-this.x-this.width/2,-this.y-this.height/2),this.getFrame(t,`spider-${Math.floor(this.distance/20)%this.manifest.spriteMap.size}`),t.setTransform(1,0,0,1,0,0),this.checkCollision())}checkCollision(){this.manifest.plants.forEach(t=>{if(t.plantBoundingRect.x<this.x+this.width&&t.plantBoundingRect.x+t.plantBoundingRect.width>this.x&&t.plantBoundingRect.y<this.y+this.height&&t.plantBoundingRect.y+t.plantBoundingRect.height>this.y){t.shrink(),s.audioPlayer.playAudio("spiderBite"),this.hasKilledAPlant=!0,window.game.state.spidersKilled+=1,window.game.state.spidersKilled===window.game.levels[window.game.state.level].numberOfSpiders&&window.game.state.level++,this.manifest.plants.reduce((t,i)=>t+i.size,0)===-1*this.manifest.plants.length&&(window.game.state.gameOver=!0)}})}drawPoints(t){this.points.y-=this.points.speed,t.font=`${this.width-10}px Anton`,t.fillStyle="white",t.textAlign="center",t.fillText(Math.floor(this.points.value*this.points.multiplier),this.x+this.width/2,this.points.y),this.points.y<0&&(this.points.shown=!1)}getFrame(t,i){const s=this.manifest.spriteMap.get(i);s&&t.drawImage(this.manifest.image,s.x,s.y,s.width,s.height,this.x+=this.velocityX*this.speed,this.y+=this.velocityY*this.speed,this.width,this.height)}onClick(){window.game.state.streak+=1,window.game.state.spidersKilledTotal+=1,window.game.state.spidersKilled+=1,this.points.multiplier=1+.1*window.game.state.streak,window.game.state.score+=Math.floor(this.points.value*this.points.multiplier),window.game.state.streak>window.game.state.biggestStreak&&(window.game.state.biggestStreak=window.game.state.streak),setTimeout(()=>s.audioPlayer.playAudio("splash"),100),this.isShot=!0,this.points.shown=!0,this.points.y=this.y,this.killer={x:this.manifest.character.upperBody.x,y:this.manifest.character.upperBody.y};const t=this.x-(this.killer.x+this.manifest.character.upperBody.width/2),i=this.y-(this.killer.y+100);this.splashAngle=Math.atan2(t,i),window.game.state.spidersKilled===window.game.levels[window.game.state.level].numberOfSpiders&&window.game.state.level++}}exports.Spider=a;class h{constructor(t){this.manifest=t}createSpiders(s,e,h){this.manifest.character=e,this.manifest.plants=h,this.manifest.speed=window.game.config.settings.spiders[window.game.difficulty].speed;let n=[];for(let o=0;o<s;o++){this.manifest.position={x:(0,i.randomIntFromRange)(-200,t.canvas.width+200),y:(0,i.randomIntFromRange)(-200,0)};const s=(0,i.randomIntFromRange)(25,80);this.manifest.width=s,this.manifest.height=s;const e=h[(0,i.randomIntFromRange)(0,h.length-1)];this.manifest.destination={x:e.x+e.width/2,y:e.y},n.push(new a(this.manifest))}return n}}exports.SpiderFactory=h;const n=async()=>{const t=await(0,e.loadManifest)("spider");t.image=await(0,e.loadImage)(t.mainImageURL),t.splashImage=await(0,e.loadImage)(t.splashImageURL);const i=new Map;return t.frames.forEach(t=>{i.set(t.name,t.rect)}),t.spriteMap=i,new h(t)};exports.loadSpiderFactory=n,document.querySelectorAll("audio").forEach(function(t){t.muted?t.muted=!1:t.muted=!0});
},{"/src/shared/canvas":"JB82","/src/shared/helpers":"OEJg","../AudioPlayer":"EWf2","./loaders":"vUgb"}],"hnsN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hideLoadingScreen=exports.updateStreak=exports.updateScore=exports.updateLevel=exports.showGameOver=exports.addEventListeners=void 0;var e=require("../AudioPlayer");const t=t=>{document.querySelector("#settings-button").addEventListener("click",()=>{document.querySelector("#settings").classList.remove("hidden"),window.game.state.paused=!0}),document.querySelector("#close-modal").addEventListener("click",()=>{document.querySelector("#settings").classList.add("hidden"),window.game.state.paused=!1}),document.querySelector("#fx-slider").addEventListener("change",t=>{e.audioPlayer.playAudio("gunshot"),e.audioPlayer.changeVolume("FX",t.target.value)}),document.querySelector("#music-slider").addEventListener("input",t=>{e.audioPlayer.changeVolume("MUSIC",t.target.value)}),document.querySelectorAll("#difficulty-setting .radio").forEach(e=>{e.addEventListener("click",e=>{window.game.difficulty=e.target.value,window.game.state.shouldRestart=!0,window.game.state.paused=!1})})};exports.addEventListeners=t;const r=()=>{document.querySelector("#gameOverScreen").classList.remove("hidden");const e=window.game.plants.reduce((e,t)=>e+1e3*t.size,0);-3e3===e?document.querySelector("#gameOverScreen .lost").classList.remove("hidden"):(document.querySelector("#gameOverScreen .win").classList.remove("hidden"),document.querySelector("#gameOverScreen #score").innerText=window.game.state.score+e,document.querySelector("#gameOverScreen #score-spiders").innerText=window.game.state.score,document.querySelector("#gameOverScreen #score-plants").innerText=e,document.querySelector("#gameOverScreen #score-streak").innerText=window.game.state.biggestStreak,document.querySelector("#gameOverScreen #score-difficulty").innerText=window.game.difficulty.toLowerCase(),document.querySelector("#gameOverScreen #score-difficulty").dataset.diff=window.game.difficulty),document.querySelector("#restart-button").addEventListener("click",()=>{document.querySelector("#gameOverScreen").classList.add("hidden"),window.game.state.shouldRestart=!0,window.game.state.paused=!1})};exports.showGameOver=r;const o=()=>{window.game.state.level>=0&&(document.querySelector("#level").innerText=window.game.state.level+1)};exports.updateLevel=o;const s=()=>{document.querySelector("#score").innerText=window.game.state.score};exports.updateScore=s;const a=()=>{const e=document.querySelector("#streak"),t=document.querySelector("#streak-container");e.innerText=Math.floor(10*(1+.1*window.game.state.streak))/10,0!==window.game.state.streak?(t.classList.remove("hidden"),e.classList.remove("streak-animation"),e.offsetWidth,e.classList.add("streak-animation")):t.classList.add("hidden")};exports.updateStreak=a;const n=()=>{document.querySelector("#loadingScreen").classList.add("hidden")};exports.hideLoadingScreen=n;
},{"../AudioPlayer":"EWf2"}],"I8vK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadPlantFactory=exports.Plant=exports.PlantFactory=void 0;var t=require("/src/shared/canvas"),e=require("/src/shared/UI"),i=require("/src/classes/loaders"),a=require("../AudioPlayer");class s{constructor(t){this.manifest=t}createPlants(i){const{width:a,height:s,image:n,loadedPlantImages:d,potMargin:l,plantSizes:o}=this.manifest,r=[],c=a*i+l*(i-1),g=(t.canvas.width-c)/2;for(let e=0;e<i;e++)r.push(new h(g+(a+(e===i?0:l))*e,t.groundY-s,o,n,d,e));return(0,e.addEventListeners)(r),r}}exports.PlantFactory=s;class h{constructor(t,e,i,a,s,h){this.id=h,this.x=t,this.y=e-15,this.size=0,this.plantSizes=i,this.planted=!1,this.showSeed=!0,this.plantImages=s,this.width=170,this.height=120,this.potCenter={x:this.x+this.width/2,y:this.y+this.height/2},this.image=a,this.timeToShowSeedButton=1,this.activePlant=i[this.size],this.activePlantImage=s[this.size],this.plantBoundingRect={x:this.potCenter.x-this.activePlant.width/2,y:this.y-this.activePlant.height,width:this.activePlant.width,height:this.activePlant.height},this.createSeedButton()}draw(t){t.drawImage(this.image,this.x,this.y,this.width,this.height),this.planted&&t.drawImage(this.activePlantImage,this.plantBoundingRect.x,this.plantBoundingRect.y,this.plantBoundingRect.width,this.plantBoundingRect.height)}grow(){a.audioPlayer.playAudio("plant"),this.size<this.plantImages.length-1&&this.planted&&(this.size++,this.activePlant=this.plantSizes[this.size],this.activePlantImage=this.plantImages[this.size],this.plantBoundingRect={x:this.potCenter.x-this.activePlant.width/2,y:this.y-this.activePlant.height,width:this.activePlant.width,height:this.activePlant.height})}shrink(){this.size>0&&this.planted?(this.size--,this.activePlant=this.plantSizes[this.size],this.activePlantImage=this.plantImages[this.size],this.plantBoundingRect={x:this.potCenter.x-this.activePlant.width/2,y:this.y-this.activePlant.height,width:this.activePlant.width,height:this.activePlant.height}):(this.size=-1,this.planted=!1)}onClick(){}plantSeed(){a.audioPlayer.playAudio("seed"),window.game.state.seedsPlanted+=1,this.planted=!0,document.querySelector(`.seedButton[data-id="${this.id}"]`).removeEventListener("click",this.plantSeed),document.querySelector(`.seedButton[data-id="${this.id}"]`).classList.remove("active")}showSeedButton(){document.querySelector(`.seedButton[data-id="${this.id}"]`).classList.add("active"),document.querySelector(`.seedButton[data-id="${this.id}"]`).addEventListener("click",this.plantSeed.bind(this))}createSeedButton(){document.querySelector(`.seedButton[data-id="${this.id}"]`)||(overlay.innerHTML+=`\n                <div \n                    class="seedButton"\n                    data-id="${this.id}"\n                    style="left: ${this.potCenter.x-40}px; top: ${this.potCenter.y-160}px;" \n                >\n                    <div class="seedButton__image">\n                    </div>\n                </div>\n            `)}}exports.Plant=h;const n=async()=>{const t=await(0,i.loadManifest)("plant");return t.image=await(0,i.loadImage)(t.mainImageURL),t.loadedPlantImages=[],Promise.all([(0,i.loadImage)(t.plantImages[0]),(0,i.loadImage)(t.plantImages[1]),(0,i.loadImage)(t.plantImages[2]),(0,i.loadImage)(t.plantImages[3])]).then(async e=>{t.loadedPlantImages=await e}),new s(t)};exports.loadPlantFactory=n;
},{"/src/shared/canvas":"JB82","/src/shared/UI":"hnsN","/src/classes/loaders":"vUgb","../AudioPlayer":"EWf2"}],"Y1Y8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadLightFactory=exports.LightFactory=exports.Light=void 0;var t=require("/src/shared/canvas"),i=require("../AudioPlayer"),h=require("./loaders");class s{constructor(t,i,h,s,e,a,o,r,g,n){this.id=t,this.width=s,this.height=e,this.x=i,this.y=h,this.lampCenter={x:this.x+this.width/2,y:this.y+this.height/2},this.turnedOn=!1,this.color=o,this.lightWidth=r,this.image=a,this.offset=10,this.isShot=!1,this.perspective=40,this.turnOn=g,this.numberOfLights=n}drawLight(i){this.turnedOn&&(i.beginPath(),i.moveTo(this.x+this.offset,this.y+this.height),0==this.id?(i.lineTo(this.x-this.lightWidth,t.canvas.height-65),i.lineTo(this.x-this.lightWidth-this.perspective,t.canvas.height)):i.lineTo(this.x-this.lightWidth,t.canvas.height),this.id==this.numberOfLights-1?(i.lineTo(this.x+ +this.width+this.lightWidth+this.perspective,t.canvas.height),i.lineTo(this.x+this.width+this.lightWidth,t.canvas.height-65)):i.lineTo(this.x+this.width+this.lightWidth,t.canvas.height),i.lineTo(this.x+this.width-this.offset,this.y+this.height),i.closePath(),i.fillStyle=this.color,i.fill())}drawBody(t){t.drawImage(this.image,this.x,this.y,this.width,this.height)}draw(i){this.drawBody(i),this.drawLight(t.maskCtx)}onClick(){this.isShot||i.audioPlayer.playAudio("glass"),this.isShot=!0}}exports.Light=s;class e{constructor(t){this.manifest=t}createLights(i,h){const{width:e,height:a,image:o,color:r,lightWidth:g,lightMargin:n}=this.manifest,d=[],l=e*i+n*(i-1),c=(t.canvas.width-l)/2;for(let t=0;t<i;t++){const l=new s(t,c+(e+(t===i?0:n))*t,0,e,a,o,r,g,t+h,i);d.push(l)}return d}}exports.LightFactory=e;const a=async()=>{const t=await(0,h.loadManifest)("light");return t.image=await(0,h.loadImage)(t.mainImageURL),new e(t)};exports.loadLightFactory=a;
},{"/src/shared/canvas":"JB82","../AudioPlayer":"EWf2","./loaders":"vUgb"}],"TssF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timer=void 0;class e{constructor(){this.startTime=0,this.timeElapsed=0}start(){this.startTime=new Date}logTimeElapsed(){let e=(new Date-this.startTime)/1e3,t=Math.round(e);this.timeElapsed!=t&&(this.timeElapsed=t)}getTimeElapsed(){return this.timeElapsed}}exports.Timer=e;
},{}],"jTI1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./character");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./scene");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./spider");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var n=require("./plant");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var u=require("./light");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});var o=require("./loaders");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})});var c=require("./timer");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});
},{"./character":"g3lD","./scene":"kGKP","./spider":"SACW","./plant":"I8vK","./light":"Y1Y8","./loaders":"vUgb","./timer":"TssF"}],"Wsaj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkTarget=void 0;const e=({clientX:e,clientY:t},c,i)=>{i(c.find(c=>!c.isShot&&e>c.x&&e<c.x+c.width&&t>c.y&&t<c.y+c.height))};exports.checkTarget=e;
},{}],"DIea":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameLoop=void 0;var e=require("/src/shared/canvas"),t=require("./classes"),a=require("/src/shared/helpers"),s=require("/src/shared/UI"),r=require("./AudioPlayer"),i=require("/src/clickHandler");const d={seedsPlanted:0,seedsShown:!1,spidersKilled:0,spidersKilledTotal:0,level:-1,currentLevel:-1,gameOver:!1,levelUpdated:!1,score:0,streak:0,biggestStreak:0,shouldRestart:!1},o="NORMAL",n=async a=>{window.game={config:a,state:JSON.parse(JSON.stringify(d)),difficulty:"NORMAL",levels:a.levels.NORMAL};let o=new t.Timer;const n=await(0,t.loadCharacter)(),w=await(0,t.loadScene)(),l=await(0,t.loadPlantFactory)(),m=await(0,t.loadLightFactory)(),g=await(0,t.loadSpiderFactory)();await r.audioPlayer.loadAllSounds(),r.audioPlayer.playMusic("music");let c=l.createPlants(a.settings.plants.numberOfPots),u=m.createLights(a.settings.lights.numberOfLights,a.timing.startLights),h=[];e.canvas.addEventListener("mousedown",e=>{(0,i.checkTarget)(e,[...h],e=>{e?e.onClick():window.game.state.streak=0,(0,s.updateScore)(),(0,s.updateStreak)(n.streak)}),(0,i.checkTarget)(e,[...u,...c],e=>{e&&e.onClick()})});const v=()=>{window.game.state.currentLevel=window.game.state.level,window.game.state.levelUpdated=!1,window.game.state.spidersKilled=0,h=[]};o.start(),(0,s.hideLoadingScreen)();const p=()=>{if(window.game.state.paused)return window.requestAnimationFrame(p);e.ctx.globalCompositeOperation="normal",w.draw(e.ctx),n.move(),h.forEach(t=>{t.draw(e.ctx)}),window.game.state.levelUpdated||(window.game.state.levelUpdated=!0,(0,s.updateLevel)()),window.game.state.seedsShown||a.timing.showSeeds<=o.getTimeElapsed()&&(window.game.state.level=0,window.game.state.seedsShown=!0,(0,s.updateLevel)()),0===window.game.state.level&&window.game.state.currentLevel!==window.game.state.level?(window.game.state.seedsPlanted==c.length&&0==h.length&&(h=g.createSpiders(window.game.levels[0].numberOfSpiders,n,c)),window.game.state.seedsShown&&c.forEach(e=>{e.showSeed&&(e.showSeedButton(),e.showSeed=!1)})):1===window.game.state.level&&window.game.state.currentLevel!==window.game.state.level?(setTimeout(()=>{h=g.createSpiders(window.game.levels[1].numberOfSpiders,n,c)},3e3),v(),c.forEach(e=>{e.grow()}),window.game.plants=c):2===window.game.state.level&&window.game.state.currentLevel!==window.game.state.level?(setTimeout(()=>{h=g.createSpiders(window.game.levels[2].numberOfSpiders,n,c)},3e3),v(),c.forEach(e=>{e.grow()})):3===window.game.state.level&&window.game.state.currentLevel!==window.game.state.level?(v(),c.forEach(e=>{e.grow()}),h=g.createSpiders(window.game.levels[3].numberOfSpiders,n,c)):4===window.game.state.level&&window.game.state.currentLevel!==window.game.state.level&&(v(),window.game.state.gameOver=!0),c.forEach(t=>{t.draw(e.ctx)}),n.draw(e.ctx),e.maskCtx.fillStyle="rgb(68, 68, 68)",e.maskCtx.fillRect(0,0,e.mask.width,e.mask.height),n.drawFlash(e.maskCtx),u.forEach(t=>{t.isShot?t.drawBody(e.ctx):(!t.turnedOn&&t.turnOn<=o.getTimeElapsed()&&(t.turnedOn=!0),t.drawBody(e.ctx),t.drawLight(e.maskCtx))}),e.ctx.globalCompositeOperation="multiply",e.ctx.drawImage(e.mask,0,0),o.logTimeElapsed(),window.game.state.gameOver||window.game.state.shouldRestart?window.game.state.shouldRestart?(window.game.state=JSON.parse(JSON.stringify(d)),h=[],document.querySelectorAll(".seedButton[data-id]").forEach(e=>{e.outerHTML=""}),document.querySelector("#gameOverScreen .win").classList.add("hidden"),document.querySelector("#gameOverScreen .lost").classList.add("hidden"),c=l.createPlants(a.settings.plants.numberOfPots),u=m.createLights(a.settings.lights.numberOfLights,a.timing.startLights),window.game.levels=window.game.config.levels[window.game.difficulty],window.game.state.streak=0,(0,s.updateStreak)(),window.game.state.shouldRestart=!1,window.requestAnimationFrame(p)):(window.game.plants=c,(0,s.showGameOver)(),window.game.state.paused=!0,window.requestAnimationFrame(p)):window.requestAnimationFrame(p)};return()=>{window.requestAnimationFrame(p)}};exports.GameLoop=n;
},{"/src/shared/canvas":"JB82","./classes":"jTI1","/src/shared/helpers":"OEJg","/src/shared/UI":"hnsN","./AudioPlayer":"EWf2","/src/clickHandler":"Wsaj"}],"FCNh":[function(require,module,exports) {
module.exports={name:"Plants and Spiders",settings:{plants:{numberOfPots:3},lights:{numberOfLights:3},spiders:{EASY:{speed:.7},NORMAL:{speed:1.1},HARD:{speed:1.5}}},timing:{showSeeds:5,startLights:2,delayBetweenLights:1},levels:{EASY:[{numberOfSpiders:7},{numberOfSpiders:12},{numberOfSpiders:17},{numberOfSpiders:20}],NORMAL:[{numberOfSpiders:15},{numberOfSpiders:18},{numberOfSpiders:20},{numberOfSpiders:23}],HARD:[{numberOfSpiders:20},{numberOfSpiders:25},{numberOfSpiders:30},{numberOfSpiders:35}]}};
},{}],"qN5A":[function(require,module,exports) {

},{"C:\\Users\\adamg\\Projects\\plants\\static\\images\\Seed.svg":[["Seed.c437c8b3.svg","qUKa"],"qUKa"],"C:\\Users\\adamg\\Projects\\plants\\static\\images\\title-background.png":[["title-background.6090d9fc.png","Ac8Q"],"Ac8Q"],"C:\\Users\\adamg\\Projects\\plants\\static\\images\\button.svg":[["button.fa43d100.svg","XkrJ"],"XkrJ"],"C:\\Users\\adamg\\Projects\\plants\\static\\images\\multiplier.svg":[["multiplier.e2b822be.svg","lSn0"],"lSn0"]}],"HJDO":[function(require,module,exports) {
"use strict";var e=require("./gameLoop"),t=s(require("/static/manifests/gameConfig.json"));function s(e){return e&&e.__esModule?e:{default:e}}require("./styles/style.scss");const r=document.querySelector("#titleScreen"),n=document.querySelector("#tutorialScreen");r.addEventListener("click",()=>{r.classList.add("hidden"),n.addEventListener("click",()=>{n.classList.add("hidden"),(0,e.GameLoop)(t.default).then(e=>{console.log("All systems are go!"),e()})})});
},{"./gameLoop":"DIea","/static/manifests/gameConfig.json":"FCNh","./styles/style.scss":"qN5A"}]},{},["HJDO"], null)
//# sourceMappingURL=main.61a07971.js.map