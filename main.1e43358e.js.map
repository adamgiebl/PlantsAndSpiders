{"version":3,"sources":["src/shared/canvas.js","src/KeyboardHandler.js","src/input.js","src/AudioPlayer.js","src/classes/loaders.js","src/classes/character.js","src/classes/scene.js","src/shared/helpers.js","src/classes/spider.js","src/shared/UI.js","src/classes/plant.js","src/classes/light.js","src/classes/timer.js","src/classes/index.js","src/clickHandler.js","src/gameLoop.js","static/manifests/gameConfig.json","src/main.js","../../AppData/Roaming/npm/node_modules/parcel/src/builtins/bundle-url.js","../../AppData/Roaming/npm/node_modules/parcel/src/builtins/css-loader.js","../../AppData/Roaming/npm/node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["canvas","document","querySelector","ctx","getContext","font","width","innerWidth","height","innerHeight","mask","createElement","maskCtx","groundPositionX","groundHeight","groundY","resizeCanvas","window","location","reload","canvasCenter","x","y","addEventListener","KeyboardHandler","constructor","keyStates","Map","keyMap","addMapping","code","callback","set","handleEvent","event","has","preventDefault","keyState","type","get","listenTo","forEach","eventName","setUpKeyboard","character","keyboard","direction","right","left","jumping","setUpMouse","clientX","clientY","rotate","e","onClick","AudioPlayer","audioContext","AudioContext","audioBuffers","muted","gainNodeFx","createGain","gainNodeMusic","loadAudio","src","fetch","then","response","arrayBuffer","decodeAudioData","addAudio","name","buffer","playAudio","source","createBufferSource","connect","destination","start","playMusic","changeVolume","value","gain","loadAllSounds","Promise","all","audioPlayer","gunshotSrc","splashSrc","glassShatterSrc","musicSrc","seedSrc","plantSrc","spiderBiteSrc","gunshot","splash","glass","music","seed","plant","spiderBite","loadImage","url","resolve","image","Image","loadManifest","res","json","loadAnimations","animations","animationsMap","animation","spriteMap","frames","frame","rect","Character","manifest","isOnGround","deltaX","deltaY","angle","velocityX","velocityY","gravity","flip","shot","distance","ready","streak","highestStreak","lowerBody","runningAnimation","jumpingAnimation","upperBody","flashAnimation","active","duration","flashImage","shootingAnimation","size","setUp","draw","rotationPoint","strokeStyle","getFrame","Math","floor","translate","runShootingAnimation","drawImage","imageFlipped","setTransform","fillStyle","move","spriteSheet","drawFlash","fillRect","atan2","PI","loadCharacter","spriteSheetURL","imageURL","flippedImageURL","flashImageURL","animationsToBeLoaded","Scene","loadScene","mainImageURL","getRandomInt","max","random","randomIntFromRange","min","checkCollision","obj1","obj2","Spider","position","speed","isShot","hasKilledAPlant","killer","splashAngle","cos","sin","points","shown","multiplier","splashImage","drawPoints","plants","plantBoundingRect","shrink","game","state","spidersKilled","levels","level","numberOfSpiders","reduce","acc","length","gameOver","textAlign","fillText","spidersKilledTotal","score","biggestStreak","setTimeout","SpiderFactory","createSpiders","config","settings","spiders","difficulty","i","push","loadSpiderFactory","splashImageURL","querySelectorAll","audioElement","addEventListeners","classList","remove","paused","add","target","input","shouldRestart","showGameOver","scorePlants","innerText","toLowerCase","dataset","diff","updateLevel","updateScore","updateStreak","streakCont","offsetWidth","hideLoadingScreen","PlantFactory","createPlants","numberOfPlants","loadedPlantImages","potMargin","plantSizes","widthSum","offset","Plant","positionX","positionY","plantImages","id","planted","showSeed","potCenter","timeToShowSeedButton","activePlant","activePlantImage","createSeedButton","grow","plantSeed","seedsPlanted","removeEventListener","showSeedButton","bind","overlay","innerHTML","loadPlantFactory","Light","color","lightWidth","turnOn","numberOfLights","lampCenter","turnedOn","perspective","drawLight","beginPath","moveTo","lineTo","closePath","fill","drawBody","LightFactory","createLights","delay","lightMargin","lights","light","loadLightFactory","Timer","startTime","timeElapsed","Date","logTimeElapsed","timeDiff","seconds","round","getTimeElapsed","checkTarget","targets","find","defaultState","seedsShown","currentLevel","levelUpdated","defaultDifficulty","GameLoop","JSON","parse","stringify","timer","scene","plantFactory","lightFactory","spiderFactory","numberOfPots","lamps","timing","startLights","entity","nextLevel","gameLoop","requestAnimationFrame","globalCompositeOperation","spider","showSeeds","lamp","el","outerHTML","module","exports","titleScreen","tutorialScreen","startGame","console","log","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","replace","bundle","require","updateLink","link","newLink","cloneNode","onload","href","split","now","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","links","OVERLAY_ID","OldModule","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","close","onclose","removeErrorOverlay","error","message","createErrorOverlay","body","appendChild","getElementById","stackTrace","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"main.1e43358e.js","sourceRoot":"..","sourcesContent":["export const canvas = document.querySelector('canvas')\r\nexport const ctx = canvas.getContext('2d')\r\nctx.font = '30px Anton'\r\ncanvas.width = innerWidth\r\ncanvas.height = innerHeight\r\nexport const mask = document.createElement('canvas')\r\nexport const maskCtx = mask.getContext('2d')\r\nmask.width = innerWidth\r\nmask.height = innerHeight\r\n\r\nexport const groundPositionX = 0\r\n\r\nexport const groundHeight = 15\r\n\r\nexport let groundY = canvas.height - groundHeight\r\n\r\nconst resizeCanvas = () => {\r\n    window.location.reload()\r\n    /*canvas.width = innerWidth\r\n    canvas.height = innerHeight\r\n    mask.width = innerWidth\r\n    mask.height = innerHeight\r\n    groundY = canvas.height - groundHeight*/\r\n}\r\n\r\nexport const canvasCenter = { x: canvas.width / 2, y: canvas.height / 2 }\r\n\r\nwindow.addEventListener('resize', resizeCanvas)\r\n","export default class KeyboardHandler {\r\n    constructor() {\r\n        // Holds the current state of a given key\r\n        this.keyStates = new Map()\r\n\r\n        // Holds the callback functions for a key code\r\n        this.keyMap = new Map()\r\n    }\r\n\r\n    addMapping(code, callback) {\r\n        this.keyMap.set(code, callback)\r\n    }\r\n\r\n    handleEvent(event) {\r\n        const { code } = event\r\n\r\n        if (!this.keyMap.has(code)) {\r\n            return\r\n        }\r\n\r\n        event.preventDefault()\r\n\r\n        const keyState = event.type === 'keydown' ? true : false\r\n\r\n        if (this.keyStates.get(code) === keyState) {\r\n            return\r\n        }\r\n\r\n        this.keyStates.set(code, keyState)\r\n\r\n        this.keyMap.get(code)(keyState)\r\n    }\r\n\r\n    listenTo(window) {\r\n        ;['keydown', 'keyup'].forEach(eventName => {\r\n            window.addEventListener(eventName, event => {\r\n                this.handleEvent(event)\r\n            })\r\n        })\r\n    }\r\n}\r\n","import KeyboardHandler from './KeyboardHandler'\r\nimport { canvas } from '/src/shared/canvas'\r\n\r\nexport const setUpKeyboard = character => {\r\n    const keyboard = new KeyboardHandler()\r\n\r\n    keyboard.addMapping('KeyD', keyState => {\r\n        character.direction.right = keyState\r\n    })\r\n\r\n    keyboard.addMapping('KeyA', keyState => {\r\n        character.direction.left = keyState\r\n    })\r\n\r\n    keyboard.addMapping('Space', keyState => {\r\n        character.direction.jumping = keyState\r\n    })\r\n\r\n    keyboard.listenTo(window)\r\n}\r\n\r\nexport const setUpMouse = character => {\r\n    canvas.addEventListener('mousemove', ({ clientX, clientY }) => {\r\n        character.rotate(clientX, clientY)\r\n    })\r\n    canvas.addEventListener('click', e => {\r\n        character.onClick()\r\n    })\r\n}\r\n","import gunshotSrc from '/static/sounds/ShotgunQuieter.mp3'\r\nimport splashSrc from '/static/sounds/Splash.mp3'\r\nimport glassShatterSrc from '/static/sounds/glass.mp3'\r\nimport musicSrc from '/static/sounds/reggae.mp3'\r\nimport seedSrc from '/static/sounds/seed.mp3'\r\nimport plantSrc from '/static/sounds/plant.mp3'\r\nimport spiderBiteSrc from '/static/sounds/spiderBite.mp3'\r\n\r\nexport class AudioPlayer {\r\n    constructor() {\r\n        this.audioContext = new AudioContext()\r\n        this.audioBuffers = new Map()\r\n        this.muted = false\r\n        this.gainNodeFx = this.audioContext.createGain()\r\n        this.gainNodeMusic = this.audioContext.createGain()\r\n    }\r\n    loadAudio(src) {\r\n        return fetch(src)\r\n            .then(response => response.arrayBuffer())\r\n            .then(arrayBuffer => this.audioContext.decodeAudioData(arrayBuffer))\r\n    }\r\n    addAudio(name, buffer) {\r\n        this.audioBuffers.set(name, buffer)\r\n    }\r\n    playAudio(name) {\r\n        const source = this.audioContext.createBufferSource()\r\n        source.connect(this.gainNodeFx)\r\n        this.gainNodeFx.connect(this.audioContext.destination)\r\n        source.buffer = this.audioBuffers.get(name)\r\n        source.start(0)\r\n    }\r\n    playMusic(name) {\r\n        const source = this.audioContext.createBufferSource()\r\n        source.connect(this.gainNodeMusic)\r\n        this.gainNodeMusic.connect(this.audioContext.destination)\r\n        source.buffer = this.audioBuffers.get(name)\r\n        source.start(0)\r\n    }\r\n    changeVolume(type, value) {\r\n        if (type === 'MUSIC') {\r\n            this.gainNodeMusic.gain.value = value\r\n        } else if (type === 'FX') {\r\n            this.gainNodeFx.gain.value = value\r\n        }\r\n    }\r\n    async loadAllSounds() {\r\n        await Promise.all([\r\n            audioPlayer.loadAudio(gunshotSrc),\r\n            audioPlayer.loadAudio(splashSrc),\r\n            audioPlayer.loadAudio(glassShatterSrc),\r\n            audioPlayer.loadAudio(musicSrc),\r\n            audioPlayer.loadAudio(seedSrc),\r\n            audioPlayer.loadAudio(plantSrc),\r\n            audioPlayer.loadAudio(spiderBiteSrc)\r\n        ]).then(([gunshot, splash, glass, music, seed, plant, spiderBite]) => {\r\n            audioPlayer.addAudio('gunshot', gunshot)\r\n            audioPlayer.addAudio('splash', splash)\r\n            audioPlayer.addAudio('glass', glass)\r\n            audioPlayer.addAudio('music', music)\r\n            audioPlayer.addAudio('seed', seed)\r\n            audioPlayer.addAudio('plant', plant)\r\n            audioPlayer.addAudio('spiderBite', spiderBite)\r\n        })\r\n    }\r\n}\r\n\r\nexport const audioPlayer = new AudioPlayer()\r\n","export function loadImage(url) {\r\n    return new Promise(resolve => {\r\n        const image = new Image()\r\n        image.addEventListener('load', () => {\r\n            resolve(image)\r\n        })\r\n        image.src = url\r\n    })\r\n}\r\n\r\nexport function loadManifest(name) {\r\n    return fetch(`./manifests/${name}.json`).then(res => res.json())\r\n}\r\n\r\nexport function loadAnimations(animations) {\r\n    const animationsMap = new Map()\r\n    animations.forEach(animation => {\r\n        const spriteMap = new Map()\r\n        animation.frames.forEach(frame => {\r\n            spriteMap.set(frame.name, frame.rect)\r\n        })\r\n        animationsMap.set(animation.name, spriteMap)\r\n    })\r\n    return animationsMap\r\n}\r\n","import { canvas } from '/src/shared/canvas'\r\nimport { groundHeight } from '/src/shared/canvas'\r\nimport { setUpKeyboard, setUpMouse } from '../input'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest, loadAnimations } from './loaders'\r\nimport { groundY } from '/src/shared/canvas'\r\n\r\nexport class Character {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n        this.direction = {\r\n            left: false,\r\n            right: false,\r\n            jumping: false\r\n        }\r\n        this.isOnGround = true\r\n        this.deltaX = 0\r\n        this.deltaY = 0\r\n        this.angle = 0\r\n        this.velocityX = 6\r\n        this.velocityY = 0\r\n        this.gravity = 0.6\r\n        this.flip = false\r\n        this.shot = false\r\n        this.distance = 0\r\n        this.ready = true\r\n        this.streak = 0\r\n        this.highestStreak = 0\r\n        this.lowerBody = {\r\n            ...this.manifest.lowerBody,\r\n            runningAnimation: this.manifest.animations.get('running'),\r\n            jumpingAnimation: this.manifest.animations.get('jumping')\r\n        }\r\n        this.upperBody = {\r\n            ...this.manifest.upperBody,\r\n            x: this.x - 30,\r\n            y: this.y - this.lowerBody.height + 70\r\n        }\r\n        this.x = 0\r\n        this.y = canvas.height - groundHeight - this.lowerBody.height + 5\r\n        this.flashAnimation = {\r\n            active: false,\r\n            duration: 3,\r\n            frame: 0,\r\n            image: this.manifest.flashImage\r\n        }\r\n        this.shootingAnimation = {\r\n            active: false,\r\n            duration: 4,\r\n            frame: 0,\r\n            size: 5\r\n        }\r\n        this.setUp()\r\n    }\r\n    draw(ctx) {\r\n        this.upperBody = {\r\n            ...this.upperBody,\r\n            rotationPoint: {\r\n                x: this.x + this.lowerBody.width / 2,\r\n                y: this.y + 25\r\n            },\r\n            x: this.x - 25,\r\n            y: this.y - this.lowerBody.height + (this.flip ? 160 : 100)\r\n        }\r\n        ctx.strokeStyle = 'red'\r\n        //ctx.strokeRect(this.x, this.y, this.lowerBody.width, this.lowerBody.height)\r\n        this.getFrame(ctx, `walk-${Math.floor(this.distance / 20) % this.lowerBody.runningAnimation.size}`)\r\n        //this.getFrame(ctx, 'walk-1')\r\n        ctx.translate(this.upperBody.rotationPoint.x, this.upperBody.rotationPoint.y)\r\n        ctx.rotate(this.angle)\r\n        ctx.translate(-this.upperBody.rotationPoint.x, -this.upperBody.rotationPoint.y)\r\n        ctx.strokeStyle = 'limegreen'\r\n        this.runShootingAnimation()\r\n        ctx.drawImage(\r\n            this.flip ? this.upperBody.imageFlipped : this.upperBody.image,\r\n            this.upperBody.x,\r\n            this.upperBody.y,\r\n            this.upperBody.width,\r\n            this.upperBody.height\r\n        )\r\n        //ctx.strokeRect(this.upperBody.x, this.upperBody.y, this.upperBody.width, this.upperBody.height)\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n        ctx.fillStyle = 'blue'\r\n        //d ctx.fillRect(this.upperBody.rotationPoint.x - 5, this.upperBody.rotationPoint.y - 5, 10, 10)\r\n    }\r\n    move() {\r\n        this.velocityY += this.gravity\r\n        this.y += this.velocityY\r\n\r\n        if (this.y + this.lowerBody.height >= groundY) {\r\n            this.y = groundY - this.lowerBody.height\r\n            this.isOnGround = true\r\n            this.velocityY = 0.0\r\n        }\r\n\r\n        if (this.direction.left) {\r\n            if (this.x > 0) {\r\n                this.x -= this.velocityX\r\n                this.distance += this.velocityX\r\n            }\r\n        } else if (this.direction.right) {\r\n            if (this.x < canvas.width - this.upperBody.width) {\r\n                this.x += this.velocityX\r\n                this.distance += this.velocityX\r\n            }\r\n        } else {\r\n            if (this.ready) this.distance = 0\r\n        }\r\n        if (this.direction.jumping) {\r\n            if (this.isOnGround) {\r\n                this.velocityY = -12.0\r\n                this.isOnGround = false\r\n            }\r\n        }\r\n    }\r\n    getFrame(ctx, name) {\r\n        if (this.isOnGround) {\r\n            const frame = this.lowerBody.runningAnimation.get(name)\r\n            if (frame) {\r\n                ctx.drawImage(\r\n                    this.lowerBody.spriteSheet,\r\n                    frame.x,\r\n                    this.flip ? frame.y + frame.height : frame.y,\r\n                    frame.width,\r\n                    frame.height,\r\n                    this.x,\r\n                    this.y,\r\n                    this.lowerBody.width,\r\n                    this.lowerBody.height\r\n                )\r\n            } else {\r\n                ctx.drawImage(\r\n                    this.lowerBody.spriteSheet,\r\n                    frame.x,\r\n                    this.flip ? frame.y + frame.height : frame.y,\r\n                    frame.width,\r\n                    frame.height,\r\n                    this.x,\r\n                    this.y,\r\n                    this.lowerBody.width,\r\n                    this.lowerBody.height\r\n                )\r\n            }\r\n        } else {\r\n            const frame = this.lowerBody.jumpingAnimation.get('jump-0')\r\n            ctx.drawImage(\r\n                this.lowerBody.spriteSheet,\r\n                frame.x,\r\n                this.flip ? frame.y + frame.height : frame.y,\r\n                frame.width,\r\n                frame.height,\r\n                this.x,\r\n                this.y,\r\n                this.lowerBody.width,\r\n                this.lowerBody.height\r\n            )\r\n        }\r\n    }\r\n    drawFlash(maskCtx) {\r\n        if (this.flashAnimation.active == true) {\r\n            if (this.flashAnimation.frame >= this.flashAnimation.duration) {\r\n                this.flashAnimation.frame = 0\r\n                this.flashAnimation.active = false\r\n            } else {\r\n                this.flashAnimation.frame++\r\n                maskCtx.fillStyle = 'rgba(249, 191, 0, 0.1)'\r\n                maskCtx.fillRect(0, 0, canvas.width, canvas.height)\r\n                maskCtx.translate(this.upperBody.rotationPoint.x, this.upperBody.rotationPoint.y)\r\n                maskCtx.rotate(this.angle)\r\n                maskCtx.translate(-this.upperBody.rotationPoint.x, -this.upperBody.rotationPoint.y)\r\n                maskCtx.strokeStyle = 'limegreen'\r\n                //ctx.strokeRect(this.upperBody.x, this.upperBody.y, this.upperBody.width, this.upperBody.height)\r\n                maskCtx.drawImage(\r\n                    this.flashAnimation.image,\r\n                    this.upperBody.x + this.upperBody.width,\r\n                    this.upperBody.y + (this.flip ? 0 : 100),\r\n                    this.upperBody.width,\r\n                    this.upperBody.height / 2\r\n                )\r\n                maskCtx.setTransform(1, 0, 0, 1, 0, 0)\r\n            }\r\n        }\r\n    }\r\n    runShootingAnimation() {\r\n        if (this.shootingAnimation.active) {\r\n            if (this.shootingAnimation.frame >= this.shootingAnimation.duration) {\r\n                this.shootingAnimation.frame = 0\r\n                this.shootingAnimation.active = false\r\n            } else {\r\n                this.shootingAnimation.frame++\r\n                this.upperBody.x = this.upperBody.x - this.shootingAnimation.size * this.shootingAnimation.frame\r\n            }\r\n        }\r\n    }\r\n    rotate(clientX, clientY) {\r\n        //const deltaX = this.x + this.upperBody.width / 2 - clientX\r\n        //const deltaY = this.y + this.upperBody.height / 2 - clientY\r\n        this.angle =\r\n            Math.atan2(this.y + this.upperBody.height / 2 - clientY, this.x + this.upperBody.width / 2 - clientX) +\r\n            Math.PI\r\n        if (this.angle > 1.5 && this.angle < 4.7) {\r\n            this.flip = true\r\n        } else {\r\n            this.flip = false\r\n        }\r\n    }\r\n    onClick() {\r\n        audioPlayer.playAudio('gunshot')\r\n        this.flashAnimation.active = true\r\n        this.shootingAnimation.active = true\r\n    }\r\n    setUp() {\r\n        setUpKeyboard(this)\r\n        setUpMouse(this)\r\n    }\r\n}\r\n\r\nexport const loadCharacter = async () => {\r\n    const manifest = await loadManifest('character')\r\n    manifest.lowerBody = {\r\n        ...manifest.lowerBody,\r\n        spriteSheet: await loadImage(manifest.lowerBody.spriteSheetURL)\r\n    }\r\n    manifest.upperBody = {\r\n        ...manifest.upperBody,\r\n        image: await loadImage(manifest.upperBody.imageURL),\r\n        imageFlipped: await loadImage(manifest.upperBody.flippedImageURL)\r\n    }\r\n    manifest.flashImage = await loadImage(manifest.flashImageURL)\r\n    manifest.animations = loadAnimations(manifest.animationsToBeLoaded)\r\n    return new Character(manifest)\r\n}\r\n","import { canvas } from '/src/shared/canvas'\r\nimport { loadImage, loadManifest } from '/src/classes/loaders'\r\n\r\nexport class Scene {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    draw(ctx) {\r\n        ctx.drawImage(this.manifest.image, 0, 0, canvas.width, canvas.height)\r\n    }\r\n}\r\n\r\nexport const loadScene = async () => {\r\n    const manifest = await loadManifest('scene')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    return new Scene(manifest)\r\n}\r\n","export function getRandomInt(max) {\r\n    return Math.floor(Math.random() * Math.floor(max))\r\n}\r\n\r\nexport function randomIntFromRange(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min)\r\n}\r\n\r\nexport function checkCollision(obj1, obj2) {\r\n    if (\r\n        obj1.x < obj2.x + obj2.width &&\r\n        obj1.x + obj1.width > obj2.x &&\r\n        obj1.y < obj2.y + obj2.height &&\r\n        obj1.y + obj1.height > obj2.y\r\n    ) {\r\n        return true\r\n    } else {\r\n        return false\r\n    }\r\n}\r\n","import { canvas, canvasCenter } from '/src/shared/canvas'\r\nimport { randomIntFromRange } from '/src/shared/helpers'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest } from './loaders'\r\n\r\nexport class Spider {\r\n    constructor(manifest) {\r\n        const { destination, position, width, height, speed } = manifest\r\n        this.manifest = manifest\r\n        this.height = width\r\n        this.width = height\r\n        this.x = position.x\r\n        this.y = position.y\r\n        this.isShot = false\r\n        this.hasKilledAPlant = false\r\n        this.killer = {}\r\n        this.deltaX = destination.x - this.x\r\n        this.deltaY = destination.y - this.y\r\n        this.angle = Math.atan2(this.deltaY, this.deltaX)\r\n        this.splashAngle = 0\r\n        this.velocityX = Math.cos(this.angle) * 1.0\r\n        this.velocityY = Math.sin(this.angle) * 1.0\r\n        this.direction = this.angle - Math.PI / 2\r\n        this.distance = 0\r\n        this.speed = speed\r\n        this.points = {\r\n            shown: false,\r\n            value: Math.floor(1000 / this.width),\r\n            y: this.y,\r\n            speed: 2,\r\n            multiplier: 1\r\n        }\r\n    }\r\n    draw(ctx) {\r\n        if (!this.isShot && !this.hasKilledAPlant) {\r\n            this.distance += 2\r\n            ctx.translate(this.x + this.width / 2, this.y + this.height / 2)\r\n            ctx.rotate(this.direction)\r\n            ctx.translate(-this.x - this.width / 2, -this.y - this.height / 2)\r\n            this.getFrame(ctx, `spider-${Math.floor(this.distance / 20) % this.manifest.spriteMap.size}`)\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n            this.checkCollision()\r\n        } else if (this.hasKilledAPlant) {\r\n        } else {\r\n            ctx.translate(this.x + this.width / 2, this.y + this.height / 2)\r\n            ctx.rotate(-this.splashAngle + Math.PI)\r\n            ctx.translate(-this.x - this.width / 2, -this.y - this.height / 2)\r\n            ctx.drawImage(\r\n                this.manifest.splashImage,\r\n                this.x - 10,\r\n                this.y - this.height,\r\n                this.width + 20,\r\n                this.height * 2\r\n            )\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n            if (this.points.shown) {\r\n                this.drawPoints(ctx)\r\n            }\r\n        }\r\n    }\r\n    checkCollision() {\r\n        this.manifest.plants.forEach(plant => {\r\n            if (\r\n                plant.plantBoundingRect.x < this.x + this.width &&\r\n                plant.plantBoundingRect.x + plant.plantBoundingRect.width > this.x &&\r\n                plant.plantBoundingRect.y < this.y + this.height &&\r\n                plant.plantBoundingRect.y + plant.plantBoundingRect.height > this.y\r\n            ) {\r\n                plant.shrink()\r\n                audioPlayer.playAudio('spiderBite')\r\n                this.hasKilledAPlant = true\r\n                window.game.state.spidersKilled += 1\r\n                if (window.game.state.spidersKilled === window.game.levels[window.game.state.level].numberOfSpiders) {\r\n                    window.game.state.level++\r\n                }\r\n                const res = this.manifest.plants.reduce((acc, plant) => {\r\n                    return acc + plant.size\r\n                }, 0)\r\n                if (res === this.manifest.plants.length * -1) {\r\n                    window.game.state.gameOver = true\r\n                }\r\n            }\r\n        })\r\n    }\r\n    drawPoints(ctx) {\r\n        this.points.y -= this.points.speed\r\n        ctx.font = `${this.width - 10}px Anton`\r\n        ctx.fillStyle = 'white'\r\n        ctx.textAlign = 'center'\r\n        ctx.fillText(Math.floor(this.points.value * this.points.multiplier), this.x + this.width / 2, this.points.y)\r\n        if (this.points.y < 0) {\r\n            this.points.shown = false\r\n        }\r\n    }\r\n    getFrame(ctx, name) {\r\n        const frame = this.manifest.spriteMap.get(name)\r\n        if (frame) {\r\n            ctx.drawImage(\r\n                this.manifest.image,\r\n                frame.x,\r\n                frame.y,\r\n                frame.width,\r\n                frame.height,\r\n                (this.x += this.velocityX * this.speed),\r\n                (this.y += this.velocityY * this.speed),\r\n                this.width,\r\n                this.height\r\n            )\r\n        }\r\n    }\r\n    onClick() {\r\n        window.game.state.streak += 1\r\n        window.game.state.spidersKilledTotal += 1\r\n        window.game.state.spidersKilled += 1\r\n        this.points.multiplier = 1 + window.game.state.streak * 0.1\r\n        window.game.state.score += Math.floor(this.points.value * this.points.multiplier)\r\n        if (window.game.state.streak > window.game.state.biggestStreak) {\r\n            window.game.state.biggestStreak = window.game.state.streak\r\n        }\r\n        setTimeout(() => audioPlayer.playAudio('splash'), 100)\r\n        this.isShot = true\r\n        this.points.shown = true\r\n        this.points.y = this.y\r\n        this.killer = { x: this.manifest.character.upperBody.x, y: this.manifest.character.upperBody.y }\r\n        const deltaX = this.x - (this.killer.x + this.manifest.character.upperBody.width / 2)\r\n        const deltaY = this.y - (this.killer.y + 100)\r\n        this.splashAngle = Math.atan2(deltaX, deltaY)\r\n        if (window.game.state.spidersKilled === window.game.levels[window.game.state.level].numberOfSpiders) {\r\n            window.game.state.level++\r\n        }\r\n    }\r\n}\r\n\r\nexport class SpiderFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    createSpiders(numberOfSpiders, character, plants) {\r\n        this.manifest.character = character\r\n        this.manifest.plants = plants\r\n        this.manifest.speed = window.game.config.settings.spiders[window.game.difficulty].speed\r\n        let spiders = []\r\n        for (let i = 0; i < numberOfSpiders; i++) {\r\n            this.manifest.position = {\r\n                x: randomIntFromRange(-200, canvas.width + 200),\r\n                y: randomIntFromRange(-200, 0)\r\n            }\r\n            const size = randomIntFromRange(25, 80)\r\n            this.manifest.width = size\r\n            this.manifest.height = size\r\n\r\n            //spider will pick a random plant and attack it\r\n            const plant = plants[randomIntFromRange(0, plants.length - 1)]\r\n            this.manifest.destination = {\r\n                x: plant.x + plant.width / 2,\r\n                y: plant.y\r\n            }\r\n            spiders.push(new Spider(this.manifest))\r\n        }\r\n        return spiders\r\n    }\r\n}\r\n\r\nexport const loadSpiderFactory = async () => {\r\n    const manifest = await loadManifest('spider')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    manifest.splashImage = await loadImage(manifest.splashImageURL)\r\n    const spriteMap = new Map()\r\n    manifest.frames.forEach(frame => {\r\n        spriteMap.set(frame.name, frame.rect)\r\n    })\r\n    manifest.spriteMap = spriteMap\r\n    return new SpiderFactory(manifest)\r\n}\r\n\r\ndocument.querySelectorAll('audio').forEach(function (audioElement) {\r\n    if (audioElement.muted) {\r\n        audioElement.muted = false\r\n    } else {\r\n        audioElement.muted = true\r\n    }\r\n})\r\n","import { audioPlayer } from '../AudioPlayer'\r\n\r\n// file for interaction between html elements and canvas\r\nexport const addEventListeners = plants => {\r\n    document.querySelector('#settings-button').addEventListener('click', () => {\r\n        document.querySelector('#settings').classList.remove('hidden')\r\n        window.game.state.paused = true\r\n    })\r\n\r\n    document.querySelector('#close-modal').addEventListener('click', () => {\r\n        document.querySelector('#settings').classList.add('hidden')\r\n        window.game.state.paused = false\r\n    })\r\n\r\n    document.querySelector('#fx-slider').addEventListener('change', e => {\r\n        audioPlayer.playAudio('gunshot')\r\n        audioPlayer.changeVolume('FX', e.target.value)\r\n    })\r\n\r\n    document.querySelector('#music-slider').addEventListener('input', e => {\r\n        audioPlayer.changeVolume('MUSIC', e.target.value)\r\n    })\r\n\r\n    document.querySelectorAll('#difficulty-setting .radio').forEach(input => {\r\n        input.addEventListener('click', e => {\r\n            window.game.difficulty = e.target.value\r\n            window.game.state.shouldRestart = true\r\n            window.game.state.paused = false\r\n        })\r\n    })\r\n}\r\n\r\nexport const showGameOver = () => {\r\n    document.querySelector('#gameOverScreen').classList.remove('hidden')\r\n    const scorePlants = window.game.plants.reduce((acc, plant) => {\r\n        return acc + plant.size * 1000\r\n    }, 0)\r\n    if (scorePlants === -3000) {\r\n        document.querySelector('#gameOverScreen .lost').classList.remove('hidden')\r\n    } else {\r\n        document.querySelector('#gameOverScreen .win').classList.remove('hidden')\r\n        document.querySelector('#gameOverScreen #score').innerText = window.game.state.score + scorePlants\r\n        document.querySelector('#gameOverScreen #score-spiders').innerText = window.game.state.score\r\n        document.querySelector('#gameOverScreen #score-plants').innerText = scorePlants\r\n        document.querySelector('#gameOverScreen #score-streak').innerText = window.game.state.biggestStreak\r\n        document.querySelector('#gameOverScreen #score-difficulty').innerText = window.game.difficulty.toLowerCase()\r\n        document.querySelector('#gameOverScreen #score-difficulty').dataset.diff = window.game.difficulty\r\n    }\r\n\r\n    document.querySelector('#restart-button').addEventListener('click', () => {\r\n        document.querySelector('#gameOverScreen').classList.add('hidden')\r\n        window.game.state.shouldRestart = true\r\n        window.game.state.paused = false\r\n    })\r\n}\r\n\r\nexport const updateLevel = () => {\r\n    if (window.game.state.level >= 0) {\r\n        document.querySelector('#level').innerText = window.game.state.level + 1\r\n        //document.querySelector('#level').classList.remove('hidden')\r\n    }\r\n}\r\n\r\nexport const updateScore = () => {\r\n    document.querySelector('#score').innerText = window.game.state.score\r\n}\r\n\r\nexport const updateStreak = () => {\r\n    const streak = document.querySelector('#streak')\r\n    const streakCont = document.querySelector('#streak-container')\r\n    streak.innerText = Math.floor((1 + window.game.state.streak * 0.1) * 10) / 10\r\n    if (window.game.state.streak !== 0) {\r\n        streakCont.classList.remove('hidden')\r\n        streak.classList.remove('streak-animation')\r\n        streak.offsetWidth\r\n        streak.classList.add('streak-animation')\r\n        //streak.style.color = '#' + (((1 << 24) * Math.random()) | 0).toString(16)\r\n    } else {\r\n        streakCont.classList.add('hidden')\r\n    }\r\n}\r\n\r\nexport const hideLoadingScreen = () => {\r\n    document.querySelector('#loadingScreen').classList.add('hidden')\r\n}\r\n","import { groundY } from '/src/shared/canvas'\r\nimport { canvas } from '/src/shared/canvas'\r\nimport { addEventListeners } from '/src/shared/UI'\r\nimport { loadImage, loadManifest } from '/src/classes/loaders'\r\nimport { audioPlayer } from '../AudioPlayer'\r\n\r\nexport class PlantFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    createPlants(numberOfPlants) {\r\n        const { width, height, image, loadedPlantImages, potMargin, plantSizes } = this.manifest\r\n        const plants = []\r\n        const widthSum = width * numberOfPlants + potMargin * (numberOfPlants - 1)\r\n        const offset = (canvas.width - widthSum) / 2\r\n        //plantSizes.reduce((acc, b) => acc + b.width, 0)\r\n\r\n        for (let i = 0; i < numberOfPlants; i++) {\r\n            plants.push(\r\n                new Plant(\r\n                    offset + (width + (i === numberOfPlants ? 0 : potMargin)) * i,\r\n                    groundY - height,\r\n                    plantSizes,\r\n                    image,\r\n                    loadedPlantImages,\r\n                    i\r\n                )\r\n            )\r\n        }\r\n        addEventListeners(plants)\r\n        return plants\r\n    }\r\n}\r\n\r\nexport class Plant {\r\n    constructor(positionX, positionY, plantSizes, image, plantImages, id) {\r\n        this.id = id\r\n        this.x = positionX\r\n        this.y = positionY - 15\r\n        this.size = 0\r\n        this.plantSizes = plantSizes\r\n        this.planted = false\r\n        this.showSeed = true\r\n        this.plantImages = plantImages\r\n        this.width = 170\r\n        this.height = 120\r\n        this.potCenter = {\r\n            x: this.x + this.width / 2,\r\n            y: this.y + this.height / 2\r\n        }\r\n        this.image = image\r\n        this.timeToShowSeedButton = 1\r\n        this.activePlant = plantSizes[this.size]\r\n        this.activePlantImage = plantImages[this.size]\r\n        this.plantBoundingRect = {\r\n            x: this.potCenter.x - this.activePlant.width / 2,\r\n            y: this.y - this.activePlant.height,\r\n            width: this.activePlant.width,\r\n            height: this.activePlant.height\r\n        }\r\n        this.createSeedButton()\r\n    }\r\n    draw(ctx) {\r\n        ctx.drawImage(this.image, this.x, this.y, this.width, this.height)\r\n        if (this.planted) {\r\n            ctx.drawImage(\r\n                this.activePlantImage,\r\n                this.plantBoundingRect.x,\r\n                this.plantBoundingRect.y,\r\n                this.plantBoundingRect.width,\r\n                this.plantBoundingRect.height\r\n            )\r\n        }\r\n    }\r\n    grow() {\r\n        audioPlayer.playAudio('plant')\r\n        if (this.size < this.plantImages.length - 1 && this.planted) {\r\n            this.size++\r\n            this.activePlant = this.plantSizes[this.size]\r\n            this.activePlantImage = this.plantImages[this.size]\r\n            this.plantBoundingRect = {\r\n                x: this.potCenter.x - this.activePlant.width / 2,\r\n                y: this.y - this.activePlant.height,\r\n                width: this.activePlant.width,\r\n                height: this.activePlant.height\r\n            }\r\n        }\r\n    }\r\n    shrink() {\r\n        if (this.size > 0 && this.planted) {\r\n            this.size--\r\n            this.activePlant = this.plantSizes[this.size]\r\n            this.activePlantImage = this.plantImages[this.size]\r\n            this.plantBoundingRect = {\r\n                x: this.potCenter.x - this.activePlant.width / 2,\r\n                y: this.y - this.activePlant.height,\r\n                width: this.activePlant.width,\r\n                height: this.activePlant.height\r\n            }\r\n        } else {\r\n            this.size = -1\r\n            this.planted = false\r\n        }\r\n    }\r\n    onClick() {\r\n        //this.grow()\r\n    }\r\n    plantSeed() {\r\n        audioPlayer.playAudio('seed')\r\n        window.game.state.seedsPlanted += 1\r\n        this.planted = true\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).removeEventListener('click', this.plantSeed)\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).classList.remove('active')\r\n    }\r\n    showSeedButton() {\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).classList.add('active')\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).addEventListener('click', this.plantSeed.bind(this))\r\n    }\r\n    createSeedButton() {\r\n        if (!document.querySelector(`.seedButton[data-id=\"${this.id}\"]`)) {\r\n            overlay.innerHTML += `\r\n                <div \r\n                    class=\"seedButton\"\r\n                    data-id=\"${this.id}\"\r\n                    style=\"left: ${this.potCenter.x - 40}px; top: ${this.potCenter.y - 160}px;\" \r\n                >\r\n                    <div class=\"seedButton__image\">\r\n                    </div>\r\n                </div>\r\n            `\r\n        }\r\n    }\r\n}\r\n\r\nexport const loadPlantFactory = async () => {\r\n    const manifest = await loadManifest('plant')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    manifest.loadedPlantImages = []\r\n    Promise.all([\r\n        loadImage(manifest.plantImages[0]),\r\n        loadImage(manifest.plantImages[1]),\r\n        loadImage(manifest.plantImages[2]),\r\n        loadImage(manifest.plantImages[3])\r\n    ]).then(async plants => {\r\n        manifest.loadedPlantImages = await plants\r\n    })\r\n    return new PlantFactory(manifest)\r\n}\r\n","import { canvas, maskCtx } from '/src/shared/canvas'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest } from './loaders'\r\n\r\nexport class Light {\r\n    constructor(id, positionX, positionY, width, height, image, color, lightWidth, turnOn, numberOfLights) {\r\n        this.id = id\r\n        this.width = width\r\n        this.height = height\r\n        this.x = positionX\r\n        this.y = positionY\r\n        this.lampCenter = {\r\n            x: this.x + this.width / 2,\r\n            y: this.y + this.height / 2\r\n        }\r\n        this.turnedOn = false\r\n        this.color = color\r\n        this.lightWidth = lightWidth\r\n        this.image = image\r\n        this.offset = 10\r\n        this.isShot = false\r\n        this.perspective = 40\r\n        this.turnOn = turnOn\r\n        this.numberOfLights = numberOfLights\r\n    }\r\n    drawLight(ctx) {\r\n        if (this.turnedOn) {\r\n            ctx.beginPath()\r\n            //top left\r\n            ctx.moveTo(this.x + this.offset, this.y + this.height)\r\n            //bottom left\r\n            if (this.id == 0) {\r\n                ctx.lineTo(this.x - this.lightWidth, canvas.height - 65)\r\n                ctx.lineTo(this.x - this.lightWidth - this.perspective, canvas.height)\r\n            } else {\r\n                ctx.lineTo(this.x - this.lightWidth, canvas.height)\r\n            }\r\n            //bottom right\r\n            if (this.id == this.numberOfLights - 1) {\r\n                ctx.lineTo(this.x + +this.width + this.lightWidth + this.perspective, canvas.height)\r\n                ctx.lineTo(this.x + this.width + this.lightWidth, canvas.height - 65)\r\n            } else {\r\n                ctx.lineTo(this.x + this.width + this.lightWidth, canvas.height)\r\n            }\r\n            //top right\r\n            ctx.lineTo(this.x + this.width - this.offset, this.y + this.height)\r\n            ctx.closePath()\r\n            ctx.fillStyle = this.color\r\n            ctx.fill()\r\n        }\r\n    }\r\n    drawBody(ctx) {\r\n        ctx.drawImage(this.image, this.x, this.y, this.width, this.height)\r\n    }\r\n    draw(ctx) {\r\n        this.drawBody(ctx)\r\n        this.drawLight(maskCtx)\r\n    }\r\n    onClick() {\r\n        if (!this.isShot) {\r\n            audioPlayer.playAudio('glass')\r\n        }\r\n        this.isShot = true\r\n    }\r\n}\r\n\r\nexport class LightFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n\r\n    createLights(numberOfLights, delay) {\r\n        const { width, height, image, color, lightWidth, lightMargin } = this.manifest\r\n        const lights = []\r\n        const widthSum = width * numberOfLights + lightMargin * (numberOfLights - 1)\r\n        const offset = (canvas.width - widthSum) / 2\r\n\r\n        for (let i = 0; i < numberOfLights; i++) {\r\n            const turnOn = i + delay\r\n            const light = new Light(\r\n                i,\r\n                offset + (width + (i === numberOfLights ? 0 : lightMargin)) * i,\r\n                0,\r\n                width,\r\n                height,\r\n                image,\r\n                color,\r\n                lightWidth,\r\n                turnOn,\r\n                numberOfLights\r\n            )\r\n            lights.push(light)\r\n        }\r\n\r\n        return lights\r\n    }\r\n}\r\n\r\nexport const loadLightFactory = async () => {\r\n    const manifest = await loadManifest('light')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    return new LightFactory(manifest)\r\n}\r\n","export class Timer {\r\n    constructor() {\r\n        this.startTime = 0\r\n        this.timeElapsed = 0\r\n    }\r\n    start() {\r\n        this.startTime = new Date()\r\n    }\r\n    logTimeElapsed() {\r\n        let timeDiff = (new Date() - this.startTime) / 1000\r\n        let seconds = Math.round(timeDiff)\r\n        if (this.timeElapsed != seconds) {\r\n            this.timeElapsed = seconds\r\n            //console.log(this.timeElapsed)\r\n        }\r\n    }\r\n    getTimeElapsed() {\r\n        return this.timeElapsed\r\n    }\r\n}\r\n","export * from './character'\r\nexport * from './scene'\r\nexport * from './spider'\r\nexport * from './plant'\r\nexport * from './light'\r\nexport * from './loaders'\r\nexport * from './timer'\r\n","export const checkTarget = ({ clientX, clientY }, targets, callback) => {\r\n    callback(\r\n        targets.find(\r\n            target =>\r\n                !target.isShot &&\r\n                clientX > target.x &&\r\n                clientX < target.x + target.width &&\r\n                clientY > target.y &&\r\n                clientY < target.y + target.height\r\n        )\r\n    )\r\n}\r\n","import { ctx, canvas, mask, maskCtx } from '/src/shared/canvas'\r\nimport { loadCharacter, loadScene, loadLightFactory, loadSpiderFactory, loadPlantFactory, Timer } from './classes'\r\nimport { randomIntFromRange } from '/src/shared/helpers'\r\nimport { showGameOver, updateLevel, hideLoadingScreen, updateScore } from '/src/shared/UI'\r\nimport { audioPlayer } from './AudioPlayer'\r\n\r\nimport { checkTarget } from '/src/clickHandler'\r\nimport { updateStreak } from '/src/shared/UI'\r\n\r\nconst defaultState = {\r\n    seedsPlanted: 0,\r\n    seedsShown: false,\r\n    spidersKilled: 0,\r\n    spidersKilledTotal: 0,\r\n    level: -1,\r\n    currentLevel: -1,\r\n    gameOver: false,\r\n    levelUpdated: false,\r\n    score: 0,\r\n    streak: 0,\r\n    biggestStreak: 0,\r\n    shouldRestart: false\r\n}\r\n\r\nconst defaultDifficulty = 'NORMAL'\r\n\r\nexport const GameLoop = async config => {\r\n    window.game = {\r\n        config: config,\r\n        state: JSON.parse(JSON.stringify(defaultState)),\r\n        difficulty: defaultDifficulty,\r\n        levels: config.levels[defaultDifficulty]\r\n    }\r\n\r\n    let timer = new Timer()\r\n    const character = await loadCharacter()\r\n    const scene = await loadScene()\r\n    const plantFactory = await loadPlantFactory()\r\n    const lightFactory = await loadLightFactory()\r\n    const spiderFactory = await loadSpiderFactory()\r\n    await audioPlayer.loadAllSounds()\r\n\r\n    audioPlayer.playMusic('music')\r\n\r\n    let plants = plantFactory.createPlants(config.settings.plants.numberOfPots)\r\n    let lamps = lightFactory.createLights(config.settings.lights.numberOfLights, config.timing.startLights)\r\n    let spiders = []\r\n\r\n    canvas.addEventListener('mousedown', e => {\r\n        checkTarget(e, [...spiders], entity => {\r\n            if (entity) entity.onClick()\r\n            else {\r\n                window.game.state.streak = 0\r\n            }\r\n            updateScore()\r\n            updateStreak(character.streak)\r\n        })\r\n        checkTarget(e, [...lamps, ...plants], entity => {\r\n            if (entity) entity.onClick()\r\n        })\r\n    })\r\n\r\n    const nextLevel = () => {\r\n        window.game.state.currentLevel = window.game.state.level\r\n        window.game.state.levelUpdated = false\r\n        window.game.state.spidersKilled = 0\r\n        spiders = []\r\n    }\r\n\r\n    timer.start()\r\n\r\n    // forcing loading screen to see the amazingness\r\n    //setTimeout(() => hideLoadingScreen(), 2000)\r\n    hideLoadingScreen()\r\n\r\n    const gameLoop = () => {\r\n        if (window.game.state.paused) return window.requestAnimationFrame(gameLoop)\r\n        ctx.globalCompositeOperation = 'normal'\r\n\r\n        scene.draw(ctx)\r\n\r\n        character.move()\r\n\r\n        spiders.forEach(spider => {\r\n            spider.draw(ctx)\r\n        })\r\n\r\n        if (!window.game.state.levelUpdated) {\r\n            window.game.state.levelUpdated = true\r\n            updateLevel()\r\n        }\r\n\r\n        if (!window.game.state.seedsShown) {\r\n            if (config.timing.showSeeds <= timer.getTimeElapsed()) {\r\n                window.game.state.level = 0\r\n                window.game.state.seedsShown = true\r\n                updateLevel()\r\n            }\r\n        }\r\n\r\n        if (window.game.state.level === 0 && window.game.state.currentLevel !== window.game.state.level) {\r\n            if (window.game.state.seedsPlanted == plants.length) {\r\n                if (spiders.length == 0) {\r\n                    spiders = spiderFactory.createSpiders(window.game.levels[0].numberOfSpiders, character, plants)\r\n                }\r\n            }\r\n            if (window.game.state.seedsShown) {\r\n                plants.forEach(plant => {\r\n                    if (plant.showSeed) {\r\n                        plant.showSeedButton()\r\n                        plant.showSeed = false\r\n                    }\r\n                })\r\n            }\r\n        } else if (window.game.state.level === 1 && window.game.state.currentLevel !== window.game.state.level) {\r\n            setTimeout(() => {\r\n                spiders = spiderFactory.createSpiders(window.game.levels[1].numberOfSpiders, character, plants)\r\n            }, 3000)\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n            window.game.plants = plants\r\n        } else if (window.game.state.level === 2 && window.game.state.currentLevel !== window.game.state.level) {\r\n            setTimeout(() => {\r\n                spiders = spiderFactory.createSpiders(window.game.levels[2].numberOfSpiders, character, plants)\r\n            }, 3000)\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n        } else if (window.game.state.level === 3 && window.game.state.currentLevel !== window.game.state.level) {\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n            spiders = spiderFactory.createSpiders(window.game.levels[3].numberOfSpiders, character, plants)\r\n        } else if (window.game.state.level === 4 && window.game.state.currentLevel !== window.game.state.level) {\r\n            nextLevel()\r\n            window.game.state.gameOver = true\r\n        }\r\n\r\n        plants.forEach(plant => {\r\n            plant.draw(ctx)\r\n        })\r\n\r\n        character.draw(ctx)\r\n\r\n        // drawing a black mask over the whole screen\r\n        maskCtx.fillStyle = 'rgb(68, 68, 68)'\r\n        //maskCtx.fillStyle = \"rgb(45, 45, 45)\";\r\n        maskCtx.fillRect(0, 0, mask.width, mask.height)\r\n\r\n        character.drawFlash(maskCtx)\r\n        // adding \"white\" light onto the mask\r\n        lamps.forEach(lamp => {\r\n            if (!lamp.isShot) {\r\n                if (!lamp.turnedOn && lamp.turnOn <= timer.getTimeElapsed()) {\r\n                    lamp.turnedOn = true\r\n                }\r\n                lamp.drawBody(ctx)\r\n                lamp.drawLight(maskCtx)\r\n            } else {\r\n                lamp.drawBody(ctx)\r\n            }\r\n        })\r\n\r\n        // multiply the mask with the underlying canvas\r\n        ctx.globalCompositeOperation = 'multiply'\r\n        ctx.drawImage(mask, 0, 0)\r\n        timer.logTimeElapsed()\r\n\r\n        if (!window.game.state.gameOver && !window.game.state.shouldRestart) {\r\n            window.requestAnimationFrame(gameLoop)\r\n        } else if (window.game.state.shouldRestart) {\r\n            // restart level\r\n            window.game.state = JSON.parse(JSON.stringify(defaultState))\r\n            spiders = []\r\n            document.querySelectorAll(`.seedButton[data-id]`).forEach(el => {\r\n                el.outerHTML = ''\r\n            })\r\n            document.querySelector('#gameOverScreen .win').classList.add('hidden')\r\n            document.querySelector('#gameOverScreen .lost').classList.add('hidden')\r\n            plants = plantFactory.createPlants(config.settings.plants.numberOfPots)\r\n            lamps = lightFactory.createLights(config.settings.lights.numberOfLights, config.timing.startLights)\r\n            window.game.levels = window.game.config.levels[window.game.difficulty]\r\n            window.game.state.streak = 0\r\n            updateStreak()\r\n            window.game.state.shouldRestart = false\r\n\r\n            window.requestAnimationFrame(gameLoop)\r\n        } else {\r\n            window.game.plants = plants\r\n            showGameOver()\r\n            window.game.state.paused = true\r\n            window.requestAnimationFrame(gameLoop)\r\n        }\r\n    }\r\n\r\n    return () => {\r\n        //setInterval(gameLoop, 1000 / 60)\r\n        window.requestAnimationFrame(gameLoop)\r\n    }\r\n}\r\n","module.exports = {\r\n    \"name\": \"Plants and Spiders\",\r\n    \"settings\" : {\r\n        \"plants\": {\r\n            \"numberOfPots\": 3\r\n        },\r\n        \"lights\": {\r\n            \"numberOfLights\": 3\r\n        },\r\n        \"spiders\": {\r\n            \"EASY\" : {\r\n                \"speed\": 0.7\r\n            },\r\n            \"NORMAL\" : {\r\n                \"speed\": 1.1\r\n            },\r\n            \"HARD\" : {\r\n                \"speed\": 1.5    \r\n            }\r\n        }\r\n    },\r\n    \"timing\": {\r\n        \"showSeeds\": 5,\r\n        \"startLights\": 2,\r\n        \"delayBetweenLights\": 1\r\n    },\r\n    \"levels\": {\r\n        \"EASY\" : [\r\n            {\r\n                \"numberOfSpiders\": 7\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 12\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 17\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 20\r\n            }\r\n        ],\r\n        \"NORMAL\" : [\r\n            { \r\n                \"numberOfSpiders\": 15\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 20\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 22\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 25\r\n            }\r\n        ],\r\n        \"HARD\" : [\r\n            { \r\n                \"numberOfSpiders\": 20\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 25\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 30\r\n            },\r\n            { \r\n                \"numberOfSpiders\": 35\r\n            }\r\n        ]\r\n    }\r\n};","import { GameLoop } from './gameLoop'\r\nimport config from '/static/manifests/gameConfig.json'\r\nimport './styles/style.scss'\r\n\r\nconst titleScreen = document.querySelector('#titleScreen')\r\nconst tutorialScreen = document.querySelector('#tutorialScreen')\r\ntitleScreen.addEventListener('click', () => {\r\n    titleScreen.classList.add('hidden')\r\n\r\n    tutorialScreen.addEventListener('click', () => {\r\n        tutorialScreen.classList.add('hidden')\r\n\r\n        GameLoop(config).then(startGame => {\r\n            console.log('All systems are go!')\r\n            startGame()\r\n        })\r\n    })\r\n})\r\n\r\n/*features:\r\n- walk up to a plant to grow\r\n- shadows undercharacters\r\n- \r\n*/\r\n\r\n/* \r\n    GAME IDEA:\r\n    - player starts with planting plants\r\n    - spiders are coming towards your plants and want to eat them\r\n    - protect plants against spiders by shooting them\r\n    - plants grow every round\r\n    - spider touching a plant will cause the plant losing one growth cycle thus becoming smaller\r\n    - there will be more spiders and they will be faster or smaller each round (making them harder to hit)\r\n    - each spider picks one of the plants to attack at the beginning of his journey\r\n    - you get points subtracted every time you miss a shot\r\n    - collect plants at the end after 4 rounds, your score depends on how much of your plants is left\r\n    - best achievable score is when all plants are fully grown after 4 rounds and you have missed no shots\r\n*/\r\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}