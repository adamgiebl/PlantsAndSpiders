{"version":3,"sources":["src/shared/canvas.js","src/KeyboardHandler.js","src/input.js","src/AudioPlayer.js","src/classes/loaders.js","src/classes/character.js","src/classes/scene.js","src/shared/helpers.js","src/classes/spider.js","src/shared/UI.js","src/classes/plant.js","src/classes/light.js","src/classes/timer.js","src/classes/index.js","src/clickHandler.js","src/gameLoop.js","static/manifests/gameConfig.json","src/main.js"],"names":["canvas","document","querySelector","ctx","getContext","font","width","innerWidth","height","innerHeight","mask","createElement","maskCtx","groundPositionX","groundHeight","groundY","resizeCanvas","window","location","reload","canvasCenter","x","y","addEventListener","KeyboardHandler","constructor","keyStates","Map","keyMap","addMapping","code","callback","set","handleEvent","event","has","preventDefault","keyState","type","get","listenTo","forEach","eventName","setUpKeyboard","character","keyboard","direction","right","left","jumping","setUpMouse","clientX","clientY","rotate","e","onClick","AudioPlayer","audioContext","AudioContext","audioBuffers","muted","gainNodeFx","createGain","gainNodeMusic","loadAudio","src","fetch","then","response","arrayBuffer","decodeAudioData","addAudio","name","buffer","playAudio","source","createBufferSource","connect","destination","start","playMusic","changeVolume","value","gain","loadAllSounds","Promise","all","audioPlayer","gunshotSrc","splashSrc","glassShatterSrc","musicSrc","seedSrc","plantSrc","spiderBiteSrc","gunshot","splash","glass","music","seed","plant","spiderBite","loadImage","url","resolve","image","Image","loadManifest","res","json","loadAnimations","animations","animationsMap","animation","spriteMap","frames","frame","rect","Character","manifest","isOnGround","deltaX","deltaY","angle","velocityX","velocityY","gravity","flip","shot","distance","ready","streak","highestStreak","lowerBody","runningAnimation","jumpingAnimation","upperBody","flashAnimation","active","duration","flashImage","shootingAnimation","size","setUp","draw","rotationPoint","strokeStyle","getFrame","Math","floor","translate","runShootingAnimation","drawImage","imageFlipped","setTransform","fillStyle","move","spriteSheet","drawFlash","fillRect","atan2","PI","loadCharacter","spriteSheetURL","imageURL","flippedImageURL","flashImageURL","animationsToBeLoaded","Scene","loadScene","mainImageURL","getRandomInt","max","random","randomIntFromRange","min","checkCollision","obj1","obj2","Spider","position","speed","isShot","hasKilledAPlant","killer","splashAngle","cos","sin","points","shown","multiplier","splashImage","drawPoints","plants","plantBoundingRect","shrink","game","state","spidersKilled","levels","level","numberOfSpiders","reduce","acc","length","gameOver","textAlign","fillText","spidersKilledTotal","score","biggestStreak","setTimeout","SpiderFactory","createSpiders","config","settings","spiders","difficulty","i","push","loadSpiderFactory","splashImageURL","querySelectorAll","audioElement","addEventListeners","classList","remove","paused","add","target","input","shouldRestart","showGameOver","scorePlants","innerText","toLowerCase","dataset","diff","updateLevel","updateScore","updateStreak","streakCont","offsetWidth","hideLoadingScreen","PlantFactory","createPlants","numberOfPlants","loadedPlantImages","potMargin","plantSizes","widthSum","offset","Plant","positionX","positionY","plantImages","id","planted","showSeed","potCenter","timeToShowSeedButton","activePlant","activePlantImage","createSeedButton","grow","plantSeed","seedsPlanted","removeEventListener","showSeedButton","bind","overlay","innerHTML","loadPlantFactory","Light","color","lightWidth","turnOn","numberOfLights","lampCenter","turnedOn","perspective","drawLight","beginPath","moveTo","lineTo","closePath","fill","drawBody","LightFactory","createLights","delay","lightMargin","lights","light","loadLightFactory","Timer","startTime","timeElapsed","Date","logTimeElapsed","timeDiff","seconds","round","getTimeElapsed","checkTarget","targets","find","defaultState","seedsShown","currentLevel","levelUpdated","defaultDifficulty","GameLoop","JSON","parse","stringify","timer","scene","plantFactory","lightFactory","spiderFactory","numberOfPots","lamps","timing","startLights","entity","nextLevel","gameLoop","requestAnimationFrame","globalCompositeOperation","spider","showSeeds","lamp","el","outerHTML","module","exports","EASY","NORMAL","HARD","delayBetweenLights","titleScreen","tutorialScreen","startGame","console","log"],"mappings":"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","file":"main.8963bc20.js","sourceRoot":"..","sourcesContent":["export const canvas = document.querySelector('canvas')\r\nexport const ctx = canvas.getContext('2d')\r\nctx.font = '30px Anton'\r\ncanvas.width = innerWidth\r\ncanvas.height = innerHeight\r\nexport const mask = document.createElement('canvas')\r\nexport const maskCtx = mask.getContext('2d')\r\nmask.width = innerWidth\r\nmask.height = innerHeight\r\n\r\nexport const groundPositionX = 0\r\n\r\nexport const groundHeight = 15\r\n\r\nexport let groundY = canvas.height - groundHeight\r\n\r\nconst resizeCanvas = () => {\r\n    window.location.reload()\r\n    /*canvas.width = innerWidth\r\n    canvas.height = innerHeight\r\n    mask.width = innerWidth\r\n    mask.height = innerHeight\r\n    groundY = canvas.height - groundHeight*/\r\n}\r\n\r\nexport const canvasCenter = { x: canvas.width / 2, y: canvas.height / 2 }\r\n\r\nwindow.addEventListener('resize', resizeCanvas)\r\n","export default class KeyboardHandler {\r\n    constructor() {\r\n        // Holds the current state of a given key\r\n        this.keyStates = new Map()\r\n\r\n        // Holds the callback functions for a key code\r\n        this.keyMap = new Map()\r\n    }\r\n\r\n    addMapping(code, callback) {\r\n        this.keyMap.set(code, callback)\r\n    }\r\n\r\n    handleEvent(event) {\r\n        const { code } = event\r\n\r\n        if (!this.keyMap.has(code)) {\r\n            return\r\n        }\r\n\r\n        event.preventDefault()\r\n\r\n        const keyState = event.type === 'keydown' ? true : false\r\n\r\n        if (this.keyStates.get(code) === keyState) {\r\n            return\r\n        }\r\n\r\n        this.keyStates.set(code, keyState)\r\n\r\n        this.keyMap.get(code)(keyState)\r\n    }\r\n\r\n    listenTo(window) {\r\n        ;['keydown', 'keyup'].forEach(eventName => {\r\n            window.addEventListener(eventName, event => {\r\n                this.handleEvent(event)\r\n            })\r\n        })\r\n    }\r\n}\r\n","import KeyboardHandler from './KeyboardHandler'\r\nimport { canvas } from '/src/shared/canvas'\r\n\r\nexport const setUpKeyboard = character => {\r\n    const keyboard = new KeyboardHandler()\r\n\r\n    keyboard.addMapping('KeyD', keyState => {\r\n        character.direction.right = keyState\r\n    })\r\n\r\n    keyboard.addMapping('KeyA', keyState => {\r\n        character.direction.left = keyState\r\n    })\r\n\r\n    keyboard.addMapping('Space', keyState => {\r\n        character.direction.jumping = keyState\r\n    })\r\n\r\n    keyboard.listenTo(window)\r\n}\r\n\r\nexport const setUpMouse = character => {\r\n    canvas.addEventListener('mousemove', ({ clientX, clientY }) => {\r\n        character.rotate(clientX, clientY)\r\n    })\r\n    canvas.addEventListener('click', e => {\r\n        character.onClick()\r\n    })\r\n}\r\n","import gunshotSrc from '/static/sounds/ShotgunQuieter.mp3'\r\nimport splashSrc from '/static/sounds/Splash.mp3'\r\nimport glassShatterSrc from '/static/sounds/glass.mp3'\r\nimport musicSrc from '/static/sounds/reggae.mp3'\r\nimport seedSrc from '/static/sounds/seed.mp3'\r\nimport plantSrc from '/static/sounds/plant.mp3'\r\nimport spiderBiteSrc from '/static/sounds/spiderBite.mp3'\r\n\r\nexport class AudioPlayer {\r\n    constructor() {\r\n        this.audioContext = new AudioContext()\r\n        this.audioBuffers = new Map()\r\n        this.muted = false\r\n        this.gainNodeFx = this.audioContext.createGain()\r\n        this.gainNodeMusic = this.audioContext.createGain()\r\n    }\r\n    loadAudio(src) {\r\n        return fetch(src)\r\n            .then(response => response.arrayBuffer())\r\n            .then(arrayBuffer => this.audioContext.decodeAudioData(arrayBuffer))\r\n    }\r\n    addAudio(name, buffer) {\r\n        this.audioBuffers.set(name, buffer)\r\n    }\r\n    playAudio(name) {\r\n        const source = this.audioContext.createBufferSource()\r\n        source.connect(this.gainNodeFx)\r\n        this.gainNodeFx.connect(this.audioContext.destination)\r\n        source.buffer = this.audioBuffers.get(name)\r\n        source.start(0)\r\n    }\r\n    playMusic(name) {\r\n        const source = this.audioContext.createBufferSource()\r\n        source.connect(this.gainNodeMusic)\r\n        this.gainNodeMusic.connect(this.audioContext.destination)\r\n        source.buffer = this.audioBuffers.get(name)\r\n        source.start(0)\r\n    }\r\n    changeVolume(type, value) {\r\n        if (type === 'MUSIC') {\r\n            this.gainNodeMusic.gain.value = value\r\n        } else if (type === 'FX') {\r\n            this.gainNodeFx.gain.value = value\r\n        }\r\n    }\r\n    async loadAllSounds() {\r\n        await Promise.all([\r\n            audioPlayer.loadAudio(gunshotSrc),\r\n            audioPlayer.loadAudio(splashSrc),\r\n            audioPlayer.loadAudio(glassShatterSrc),\r\n            audioPlayer.loadAudio(musicSrc),\r\n            audioPlayer.loadAudio(seedSrc),\r\n            audioPlayer.loadAudio(plantSrc),\r\n            audioPlayer.loadAudio(spiderBiteSrc)\r\n        ]).then(([gunshot, splash, glass, music, seed, plant, spiderBite]) => {\r\n            audioPlayer.addAudio('gunshot', gunshot)\r\n            audioPlayer.addAudio('splash', splash)\r\n            audioPlayer.addAudio('glass', glass)\r\n            audioPlayer.addAudio('music', music)\r\n            audioPlayer.addAudio('seed', seed)\r\n            audioPlayer.addAudio('plant', plant)\r\n            audioPlayer.addAudio('spiderBite', spiderBite)\r\n        })\r\n    }\r\n}\r\n\r\nexport const audioPlayer = new AudioPlayer()\r\n","export function loadImage(url) {\r\n    return new Promise(resolve => {\r\n        const image = new Image()\r\n        image.addEventListener('load', () => {\r\n            resolve(image)\r\n        })\r\n        image.src = url\r\n    })\r\n}\r\n\r\nexport function loadManifest(name) {\r\n    return fetch(`./manifests/${name}.json`).then(res => res.json())\r\n}\r\n\r\nexport function loadAnimations(animations) {\r\n    const animationsMap = new Map()\r\n    animations.forEach(animation => {\r\n        const spriteMap = new Map()\r\n        animation.frames.forEach(frame => {\r\n            spriteMap.set(frame.name, frame.rect)\r\n        })\r\n        animationsMap.set(animation.name, spriteMap)\r\n    })\r\n    return animationsMap\r\n}\r\n","import { canvas } from '/src/shared/canvas'\r\nimport { groundHeight } from '/src/shared/canvas'\r\nimport { setUpKeyboard, setUpMouse } from '../input'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest, loadAnimations } from './loaders'\r\nimport { groundY } from '/src/shared/canvas'\r\n\r\nexport class Character {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n        this.direction = {\r\n            left: false,\r\n            right: false,\r\n            jumping: false\r\n        }\r\n        this.isOnGround = true\r\n        this.deltaX = 0\r\n        this.deltaY = 0\r\n        this.angle = 0\r\n        this.velocityX = 6\r\n        this.velocityY = 0\r\n        this.gravity = 0.6\r\n        this.flip = false\r\n        this.shot = false\r\n        this.distance = 0\r\n        this.ready = true\r\n        this.streak = 0\r\n        this.highestStreak = 0\r\n        this.lowerBody = {\r\n            ...this.manifest.lowerBody,\r\n            runningAnimation: this.manifest.animations.get('running'),\r\n            jumpingAnimation: this.manifest.animations.get('jumping')\r\n        }\r\n        this.upperBody = {\r\n            ...this.manifest.upperBody,\r\n            x: this.x - 30,\r\n            y: this.y - this.lowerBody.height + 70\r\n        }\r\n        this.x = 0\r\n        this.y = canvas.height - groundHeight - this.lowerBody.height + 5\r\n        this.flashAnimation = {\r\n            active: false,\r\n            duration: 3,\r\n            frame: 0,\r\n            image: this.manifest.flashImage\r\n        }\r\n        this.shootingAnimation = {\r\n            active: false,\r\n            duration: 4,\r\n            frame: 0,\r\n            size: 5\r\n        }\r\n        this.setUp()\r\n    }\r\n    draw(ctx) {\r\n        this.upperBody = {\r\n            ...this.upperBody,\r\n            rotationPoint: {\r\n                x: this.x + this.lowerBody.width / 2,\r\n                y: this.y + 25\r\n            },\r\n            x: this.x - 25,\r\n            y: this.y - this.lowerBody.height + (this.flip ? 160 : 100)\r\n        }\r\n        ctx.strokeStyle = 'red'\r\n        //ctx.strokeRect(this.x, this.y, this.lowerBody.width, this.lowerBody.height)\r\n        this.getFrame(ctx, `walk-${Math.floor(this.distance / 20) % this.lowerBody.runningAnimation.size}`)\r\n        //this.getFrame(ctx, 'walk-1')\r\n        ctx.translate(this.upperBody.rotationPoint.x, this.upperBody.rotationPoint.y)\r\n        ctx.rotate(this.angle)\r\n        ctx.translate(-this.upperBody.rotationPoint.x, -this.upperBody.rotationPoint.y)\r\n        ctx.strokeStyle = 'limegreen'\r\n        this.runShootingAnimation()\r\n        ctx.drawImage(\r\n            this.flip ? this.upperBody.imageFlipped : this.upperBody.image,\r\n            this.upperBody.x,\r\n            this.upperBody.y,\r\n            this.upperBody.width,\r\n            this.upperBody.height\r\n        )\r\n        //ctx.strokeRect(this.upperBody.x, this.upperBody.y, this.upperBody.width, this.upperBody.height)\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n        ctx.fillStyle = 'blue'\r\n        //d ctx.fillRect(this.upperBody.rotationPoint.x - 5, this.upperBody.rotationPoint.y - 5, 10, 10)\r\n    }\r\n    move() {\r\n        this.velocityY += this.gravity\r\n        this.y += this.velocityY\r\n\r\n        if (this.y + this.lowerBody.height >= groundY) {\r\n            this.y = groundY - this.lowerBody.height\r\n            this.isOnGround = true\r\n            this.velocityY = 0.0\r\n        }\r\n\r\n        if (this.direction.left) {\r\n            if (this.x > 0) {\r\n                this.x -= this.velocityX\r\n                this.distance += this.velocityX\r\n            }\r\n        } else if (this.direction.right) {\r\n            if (this.x < canvas.width - this.upperBody.width) {\r\n                this.x += this.velocityX\r\n                this.distance += this.velocityX\r\n            }\r\n        } else {\r\n            if (this.ready) this.distance = 0\r\n        }\r\n        if (this.direction.jumping) {\r\n            if (this.isOnGround) {\r\n                this.velocityY = -12.0\r\n                this.isOnGround = false\r\n            }\r\n        }\r\n    }\r\n    getFrame(ctx, name) {\r\n        if (this.isOnGround) {\r\n            const frame = this.lowerBody.runningAnimation.get(name)\r\n            if (frame) {\r\n                ctx.drawImage(\r\n                    this.lowerBody.spriteSheet,\r\n                    frame.x,\r\n                    this.flip ? frame.y + frame.height : frame.y,\r\n                    frame.width,\r\n                    frame.height,\r\n                    this.x,\r\n                    this.y,\r\n                    this.lowerBody.width,\r\n                    this.lowerBody.height\r\n                )\r\n            } else {\r\n                ctx.drawImage(\r\n                    this.lowerBody.spriteSheet,\r\n                    frame.x,\r\n                    this.flip ? frame.y + frame.height : frame.y,\r\n                    frame.width,\r\n                    frame.height,\r\n                    this.x,\r\n                    this.y,\r\n                    this.lowerBody.width,\r\n                    this.lowerBody.height\r\n                )\r\n            }\r\n        } else {\r\n            const frame = this.lowerBody.jumpingAnimation.get('jump-0')\r\n            ctx.drawImage(\r\n                this.lowerBody.spriteSheet,\r\n                frame.x,\r\n                this.flip ? frame.y + frame.height : frame.y,\r\n                frame.width,\r\n                frame.height,\r\n                this.x,\r\n                this.y,\r\n                this.lowerBody.width,\r\n                this.lowerBody.height\r\n            )\r\n        }\r\n    }\r\n    drawFlash(maskCtx) {\r\n        if (this.flashAnimation.active == true) {\r\n            if (this.flashAnimation.frame >= this.flashAnimation.duration) {\r\n                this.flashAnimation.frame = 0\r\n                this.flashAnimation.active = false\r\n            } else {\r\n                this.flashAnimation.frame++\r\n                maskCtx.fillStyle = 'rgba(249, 191, 0, 0.1)'\r\n                maskCtx.fillRect(0, 0, canvas.width, canvas.height)\r\n                maskCtx.translate(this.upperBody.rotationPoint.x, this.upperBody.rotationPoint.y)\r\n                maskCtx.rotate(this.angle)\r\n                maskCtx.translate(-this.upperBody.rotationPoint.x, -this.upperBody.rotationPoint.y)\r\n                maskCtx.strokeStyle = 'limegreen'\r\n                //ctx.strokeRect(this.upperBody.x, this.upperBody.y, this.upperBody.width, this.upperBody.height)\r\n                maskCtx.drawImage(\r\n                    this.flashAnimation.image,\r\n                    this.upperBody.x + this.upperBody.width,\r\n                    this.upperBody.y + (this.flip ? 0 : 100),\r\n                    this.upperBody.width,\r\n                    this.upperBody.height / 2\r\n                )\r\n                maskCtx.setTransform(1, 0, 0, 1, 0, 0)\r\n            }\r\n        }\r\n    }\r\n    runShootingAnimation() {\r\n        if (this.shootingAnimation.active) {\r\n            if (this.shootingAnimation.frame >= this.shootingAnimation.duration) {\r\n                this.shootingAnimation.frame = 0\r\n                this.shootingAnimation.active = false\r\n            } else {\r\n                this.shootingAnimation.frame++\r\n                this.upperBody.x = this.upperBody.x - this.shootingAnimation.size * this.shootingAnimation.frame\r\n            }\r\n        }\r\n    }\r\n    rotate(clientX, clientY) {\r\n        //const deltaX = this.x + this.upperBody.width / 2 - clientX\r\n        //const deltaY = this.y + this.upperBody.height / 2 - clientY\r\n        this.angle =\r\n            Math.atan2(this.y + this.upperBody.height / 2 - clientY, this.x + this.upperBody.width / 2 - clientX) +\r\n            Math.PI\r\n        if (this.angle > 1.5 && this.angle < 4.7) {\r\n            this.flip = true\r\n        } else {\r\n            this.flip = false\r\n        }\r\n    }\r\n    onClick() {\r\n        audioPlayer.playAudio('gunshot')\r\n        this.flashAnimation.active = true\r\n        this.shootingAnimation.active = true\r\n    }\r\n    setUp() {\r\n        setUpKeyboard(this)\r\n        setUpMouse(this)\r\n    }\r\n}\r\n\r\nexport const loadCharacter = async () => {\r\n    const manifest = await loadManifest('character')\r\n    manifest.lowerBody = {\r\n        ...manifest.lowerBody,\r\n        spriteSheet: await loadImage(manifest.lowerBody.spriteSheetURL)\r\n    }\r\n    manifest.upperBody = {\r\n        ...manifest.upperBody,\r\n        image: await loadImage(manifest.upperBody.imageURL),\r\n        imageFlipped: await loadImage(manifest.upperBody.flippedImageURL)\r\n    }\r\n    manifest.flashImage = await loadImage(manifest.flashImageURL)\r\n    manifest.animations = loadAnimations(manifest.animationsToBeLoaded)\r\n    return new Character(manifest)\r\n}\r\n","import { canvas } from '/src/shared/canvas'\r\nimport { loadImage, loadManifest } from '/src/classes/loaders'\r\n\r\nexport class Scene {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    draw(ctx) {\r\n        ctx.drawImage(this.manifest.image, 0, 0, canvas.width, canvas.height)\r\n    }\r\n}\r\n\r\nexport const loadScene = async () => {\r\n    const manifest = await loadManifest('scene')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    return new Scene(manifest)\r\n}\r\n","export function getRandomInt(max) {\r\n    return Math.floor(Math.random() * Math.floor(max))\r\n}\r\n\r\nexport function randomIntFromRange(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min)\r\n}\r\n\r\nexport function checkCollision(obj1, obj2) {\r\n    if (\r\n        obj1.x < obj2.x + obj2.width &&\r\n        obj1.x + obj1.width > obj2.x &&\r\n        obj1.y < obj2.y + obj2.height &&\r\n        obj1.y + obj1.height > obj2.y\r\n    ) {\r\n        return true\r\n    } else {\r\n        return false\r\n    }\r\n}\r\n","import { canvas, canvasCenter } from '/src/shared/canvas'\r\nimport { randomIntFromRange } from '/src/shared/helpers'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest } from './loaders'\r\n\r\nexport class Spider {\r\n    constructor(manifest) {\r\n        const { destination, position, width, height, speed } = manifest\r\n        this.manifest = manifest\r\n        this.height = width\r\n        this.width = height\r\n        this.x = position.x\r\n        this.y = position.y\r\n        this.isShot = false\r\n        this.hasKilledAPlant = false\r\n        this.killer = {}\r\n        this.deltaX = destination.x - this.x\r\n        this.deltaY = destination.y - this.y\r\n        this.angle = Math.atan2(this.deltaY, this.deltaX)\r\n        this.splashAngle = 0\r\n        this.velocityX = Math.cos(this.angle) * 1.0\r\n        this.velocityY = Math.sin(this.angle) * 1.0\r\n        this.direction = this.angle - Math.PI / 2\r\n        this.distance = 0\r\n        this.speed = speed\r\n        this.points = {\r\n            shown: false,\r\n            value: Math.floor(1000 / this.width),\r\n            y: this.y,\r\n            speed: 2,\r\n            multiplier: 1\r\n        }\r\n    }\r\n    draw(ctx) {\r\n        if (!this.isShot && !this.hasKilledAPlant) {\r\n            this.distance += 2\r\n            ctx.translate(this.x + this.width / 2, this.y + this.height / 2)\r\n            ctx.rotate(this.direction)\r\n            ctx.translate(-this.x - this.width / 2, -this.y - this.height / 2)\r\n            this.getFrame(ctx, `spider-${Math.floor(this.distance / 20) % this.manifest.spriteMap.size}`)\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n            this.checkCollision()\r\n        } else if (this.hasKilledAPlant) {\r\n        } else {\r\n            ctx.translate(this.x + this.width / 2, this.y + this.height / 2)\r\n            ctx.rotate(-this.splashAngle + Math.PI)\r\n            ctx.translate(-this.x - this.width / 2, -this.y - this.height / 2)\r\n            ctx.drawImage(\r\n                this.manifest.splashImage,\r\n                this.x - 10,\r\n                this.y - this.height,\r\n                this.width + 20,\r\n                this.height * 2\r\n            )\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n            if (this.points.shown) {\r\n                this.drawPoints(ctx)\r\n            }\r\n        }\r\n    }\r\n    checkCollision() {\r\n        this.manifest.plants.forEach(plant => {\r\n            if (\r\n                plant.plantBoundingRect.x < this.x + this.width &&\r\n                plant.plantBoundingRect.x + plant.plantBoundingRect.width > this.x &&\r\n                plant.plantBoundingRect.y < this.y + this.height &&\r\n                plant.plantBoundingRect.y + plant.plantBoundingRect.height > this.y\r\n            ) {\r\n                plant.shrink()\r\n                audioPlayer.playAudio('spiderBite')\r\n                this.hasKilledAPlant = true\r\n                window.game.state.spidersKilled += 1\r\n                if (window.game.state.spidersKilled === window.game.levels[window.game.state.level].numberOfSpiders) {\r\n                    window.game.state.level++\r\n                }\r\n                const res = this.manifest.plants.reduce((acc, plant) => {\r\n                    return acc + plant.size\r\n                }, 0)\r\n                if (res === this.manifest.plants.length * -1) {\r\n                    window.game.state.gameOver = true\r\n                }\r\n            }\r\n        })\r\n    }\r\n    drawPoints(ctx) {\r\n        this.points.y -= this.points.speed\r\n        ctx.font = `${this.width - 10}px Anton`\r\n        ctx.fillStyle = 'white'\r\n        ctx.textAlign = 'center'\r\n        ctx.fillText(Math.floor(this.points.value * this.points.multiplier), this.x + this.width / 2, this.points.y)\r\n        if (this.points.y < 0) {\r\n            this.points.shown = false\r\n        }\r\n    }\r\n    getFrame(ctx, name) {\r\n        const frame = this.manifest.spriteMap.get(name)\r\n        if (frame) {\r\n            ctx.drawImage(\r\n                this.manifest.image,\r\n                frame.x,\r\n                frame.y,\r\n                frame.width,\r\n                frame.height,\r\n                (this.x += this.velocityX * this.speed),\r\n                (this.y += this.velocityY * this.speed),\r\n                this.width,\r\n                this.height\r\n            )\r\n        }\r\n    }\r\n    onClick() {\r\n        window.game.state.streak += 1\r\n        window.game.state.spidersKilledTotal += 1\r\n        window.game.state.spidersKilled += 1\r\n        this.points.multiplier = 1 + window.game.state.streak * 0.1\r\n        window.game.state.score += Math.floor(this.points.value * this.points.multiplier)\r\n        if (window.game.state.streak > window.game.state.biggestStreak) {\r\n            window.game.state.biggestStreak = window.game.state.streak\r\n        }\r\n        setTimeout(() => audioPlayer.playAudio('splash'), 100)\r\n        this.isShot = true\r\n        this.points.shown = true\r\n        this.points.y = this.y\r\n        this.killer = { x: this.manifest.character.upperBody.x, y: this.manifest.character.upperBody.y }\r\n        const deltaX = this.x - (this.killer.x + this.manifest.character.upperBody.width / 2)\r\n        const deltaY = this.y - (this.killer.y + 100)\r\n        this.splashAngle = Math.atan2(deltaX, deltaY)\r\n        if (window.game.state.spidersKilled === window.game.levels[window.game.state.level].numberOfSpiders) {\r\n            window.game.state.level++\r\n        }\r\n    }\r\n}\r\n\r\nexport class SpiderFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    createSpiders(numberOfSpiders, character, plants) {\r\n        this.manifest.character = character\r\n        this.manifest.plants = plants\r\n        this.manifest.speed = window.game.config.settings.spiders[window.game.difficulty].speed\r\n        let spiders = []\r\n        for (let i = 0; i < numberOfSpiders; i++) {\r\n            this.manifest.position = {\r\n                x: randomIntFromRange(-200, canvas.width + 200),\r\n                y: randomIntFromRange(-200, 0)\r\n            }\r\n            const size = randomIntFromRange(25, 80)\r\n            this.manifest.width = size\r\n            this.manifest.height = size\r\n\r\n            //spider will pick a random plant and attack it\r\n            const plant = plants[randomIntFromRange(0, plants.length - 1)]\r\n            this.manifest.destination = {\r\n                x: plant.x + plant.width / 2,\r\n                y: plant.y\r\n            }\r\n            spiders.push(new Spider(this.manifest))\r\n        }\r\n        return spiders\r\n    }\r\n}\r\n\r\nexport const loadSpiderFactory = async () => {\r\n    const manifest = await loadManifest('spider')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    manifest.splashImage = await loadImage(manifest.splashImageURL)\r\n    const spriteMap = new Map()\r\n    manifest.frames.forEach(frame => {\r\n        spriteMap.set(frame.name, frame.rect)\r\n    })\r\n    manifest.spriteMap = spriteMap\r\n    return new SpiderFactory(manifest)\r\n}\r\n\r\ndocument.querySelectorAll('audio').forEach(function (audioElement) {\r\n    if (audioElement.muted) {\r\n        audioElement.muted = false\r\n    } else {\r\n        audioElement.muted = true\r\n    }\r\n})\r\n","import { audioPlayer } from '../AudioPlayer'\r\n\r\n// file for interaction between html elements and canvas\r\nexport const addEventListeners = plants => {\r\n    document.querySelector('#settings-button').addEventListener('click', () => {\r\n        document.querySelector('#settings').classList.remove('hidden')\r\n        window.game.state.paused = true\r\n    })\r\n\r\n    document.querySelector('#close-modal').addEventListener('click', () => {\r\n        document.querySelector('#settings').classList.add('hidden')\r\n        window.game.state.paused = false\r\n    })\r\n\r\n    document.querySelector('#fx-slider').addEventListener('change', e => {\r\n        audioPlayer.playAudio('gunshot')\r\n        audioPlayer.changeVolume('FX', e.target.value)\r\n    })\r\n\r\n    document.querySelector('#music-slider').addEventListener('input', e => {\r\n        audioPlayer.changeVolume('MUSIC', e.target.value)\r\n    })\r\n\r\n    document.querySelectorAll('#difficulty-setting .radio').forEach(input => {\r\n        input.addEventListener('click', e => {\r\n            window.game.difficulty = e.target.value\r\n            window.game.state.shouldRestart = true\r\n            window.game.state.paused = false\r\n        })\r\n    })\r\n}\r\n\r\nexport const showGameOver = () => {\r\n    document.querySelector('#gameOverScreen').classList.remove('hidden')\r\n    const scorePlants = window.game.plants.reduce((acc, plant) => {\r\n        return acc + plant.size * 1000\r\n    }, 0)\r\n    if (scorePlants === -3000) {\r\n        document.querySelector('#gameOverScreen .lost').classList.remove('hidden')\r\n    } else {\r\n        document.querySelector('#gameOverScreen .win').classList.remove('hidden')\r\n        document.querySelector('#gameOverScreen #score').innerText = window.game.state.score + scorePlants\r\n        document.querySelector('#gameOverScreen #score-spiders').innerText = window.game.state.score\r\n        document.querySelector('#gameOverScreen #score-plants').innerText = scorePlants\r\n        document.querySelector('#gameOverScreen #score-streak').innerText = window.game.state.biggestStreak\r\n        document.querySelector('#gameOverScreen #score-difficulty').innerText = window.game.difficulty.toLowerCase()\r\n        document.querySelector('#gameOverScreen #score-difficulty').dataset.diff = window.game.difficulty\r\n    }\r\n\r\n    document.querySelector('#restart-button').addEventListener('click', () => {\r\n        document.querySelector('#gameOverScreen').classList.add('hidden')\r\n        window.game.state.shouldRestart = true\r\n        window.game.state.paused = false\r\n    })\r\n}\r\n\r\nexport const updateLevel = () => {\r\n    if (window.game.state.level >= 0) {\r\n        document.querySelector('#level').innerText = window.game.state.level + 1\r\n        //document.querySelector('#level').classList.remove('hidden')\r\n    }\r\n}\r\n\r\nexport const updateScore = () => {\r\n    document.querySelector('#score').innerText = window.game.state.score\r\n}\r\n\r\nexport const updateStreak = () => {\r\n    const streak = document.querySelector('#streak')\r\n    const streakCont = document.querySelector('#streak-container')\r\n    streak.innerText = Math.floor((1 + window.game.state.streak * 0.1) * 10) / 10\r\n    if (window.game.state.streak !== 0) {\r\n        streakCont.classList.remove('hidden')\r\n        streak.classList.remove('streak-animation')\r\n        streak.offsetWidth\r\n        streak.classList.add('streak-animation')\r\n        //streak.style.color = '#' + (((1 << 24) * Math.random()) | 0).toString(16)\r\n    } else {\r\n        streakCont.classList.add('hidden')\r\n    }\r\n}\r\n\r\nexport const hideLoadingScreen = () => {\r\n    document.querySelector('#loadingScreen').classList.add('hidden')\r\n}\r\n","import { groundY } from '/src/shared/canvas'\r\nimport { canvas } from '/src/shared/canvas'\r\nimport { addEventListeners } from '/src/shared/UI'\r\nimport { loadImage, loadManifest } from '/src/classes/loaders'\r\nimport { audioPlayer } from '../AudioPlayer'\r\n\r\nexport class PlantFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n    createPlants(numberOfPlants) {\r\n        const { width, height, image, loadedPlantImages, potMargin, plantSizes } = this.manifest\r\n        const plants = []\r\n        const widthSum = width * numberOfPlants + potMargin * (numberOfPlants - 1)\r\n        const offset = (canvas.width - widthSum) / 2\r\n        //plantSizes.reduce((acc, b) => acc + b.width, 0)\r\n\r\n        for (let i = 0; i < numberOfPlants; i++) {\r\n            plants.push(\r\n                new Plant(\r\n                    offset + (width + (i === numberOfPlants ? 0 : potMargin)) * i,\r\n                    groundY - height,\r\n                    plantSizes,\r\n                    image,\r\n                    loadedPlantImages,\r\n                    i\r\n                )\r\n            )\r\n        }\r\n        addEventListeners(plants)\r\n        return plants\r\n    }\r\n}\r\n\r\nexport class Plant {\r\n    constructor(positionX, positionY, plantSizes, image, plantImages, id) {\r\n        this.id = id\r\n        this.x = positionX\r\n        this.y = positionY - 15\r\n        this.size = 0\r\n        this.plantSizes = plantSizes\r\n        this.planted = false\r\n        this.showSeed = true\r\n        this.plantImages = plantImages\r\n        this.width = 170\r\n        this.height = 120\r\n        this.potCenter = {\r\n            x: this.x + this.width / 2,\r\n            y: this.y + this.height / 2\r\n        }\r\n        this.image = image\r\n        this.timeToShowSeedButton = 1\r\n        this.activePlant = plantSizes[this.size]\r\n        this.activePlantImage = plantImages[this.size]\r\n        this.plantBoundingRect = {\r\n            x: this.potCenter.x - this.activePlant.width / 2,\r\n            y: this.y - this.activePlant.height,\r\n            width: this.activePlant.width,\r\n            height: this.activePlant.height\r\n        }\r\n        this.createSeedButton()\r\n    }\r\n    draw(ctx) {\r\n        ctx.drawImage(this.image, this.x, this.y, this.width, this.height)\r\n        if (this.planted) {\r\n            ctx.drawImage(\r\n                this.activePlantImage,\r\n                this.plantBoundingRect.x,\r\n                this.plantBoundingRect.y,\r\n                this.plantBoundingRect.width,\r\n                this.plantBoundingRect.height\r\n            )\r\n        }\r\n    }\r\n    grow() {\r\n        audioPlayer.playAudio('plant')\r\n        if (this.size < this.plantImages.length - 1 && this.planted) {\r\n            this.size++\r\n            this.activePlant = this.plantSizes[this.size]\r\n            this.activePlantImage = this.plantImages[this.size]\r\n            this.plantBoundingRect = {\r\n                x: this.potCenter.x - this.activePlant.width / 2,\r\n                y: this.y - this.activePlant.height,\r\n                width: this.activePlant.width,\r\n                height: this.activePlant.height\r\n            }\r\n        }\r\n    }\r\n    shrink() {\r\n        if (this.size > 0 && this.planted) {\r\n            this.size--\r\n            this.activePlant = this.plantSizes[this.size]\r\n            this.activePlantImage = this.plantImages[this.size]\r\n            this.plantBoundingRect = {\r\n                x: this.potCenter.x - this.activePlant.width / 2,\r\n                y: this.y - this.activePlant.height,\r\n                width: this.activePlant.width,\r\n                height: this.activePlant.height\r\n            }\r\n        } else {\r\n            this.size = -1\r\n            this.planted = false\r\n        }\r\n    }\r\n    onClick() {\r\n        //this.grow()\r\n    }\r\n    plantSeed() {\r\n        audioPlayer.playAudio('seed')\r\n        window.game.state.seedsPlanted += 1\r\n        this.planted = true\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).removeEventListener('click', this.plantSeed)\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).classList.remove('active')\r\n    }\r\n    showSeedButton() {\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).classList.add('active')\r\n        document.querySelector(`.seedButton[data-id=\"${this.id}\"]`).addEventListener('click', this.plantSeed.bind(this))\r\n    }\r\n    createSeedButton() {\r\n        if (!document.querySelector(`.seedButton[data-id=\"${this.id}\"]`)) {\r\n            overlay.innerHTML += `\r\n                <div \r\n                    class=\"seedButton\"\r\n                    data-id=\"${this.id}\"\r\n                    style=\"left: ${this.potCenter.x - 40}px; top: ${this.potCenter.y - 160}px;\" \r\n                >\r\n                    <div class=\"seedButton__image\">\r\n                    </div>\r\n                </div>\r\n            `\r\n        }\r\n    }\r\n}\r\n\r\nexport const loadPlantFactory = async () => {\r\n    const manifest = await loadManifest('plant')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    manifest.loadedPlantImages = []\r\n    Promise.all([\r\n        loadImage(manifest.plantImages[0]),\r\n        loadImage(manifest.plantImages[1]),\r\n        loadImage(manifest.plantImages[2]),\r\n        loadImage(manifest.plantImages[3])\r\n    ]).then(async plants => {\r\n        manifest.loadedPlantImages = await plants\r\n    })\r\n    return new PlantFactory(manifest)\r\n}\r\n","import { canvas, maskCtx } from '/src/shared/canvas'\r\nimport { audioPlayer } from '../AudioPlayer'\r\nimport { loadImage, loadManifest } from './loaders'\r\n\r\nexport class Light {\r\n    constructor(id, positionX, positionY, width, height, image, color, lightWidth, turnOn, numberOfLights) {\r\n        this.id = id\r\n        this.width = width\r\n        this.height = height\r\n        this.x = positionX\r\n        this.y = positionY\r\n        this.lampCenter = {\r\n            x: this.x + this.width / 2,\r\n            y: this.y + this.height / 2\r\n        }\r\n        this.turnedOn = false\r\n        this.color = color\r\n        this.lightWidth = lightWidth\r\n        this.image = image\r\n        this.offset = 10\r\n        this.isShot = false\r\n        this.perspective = 40\r\n        this.turnOn = turnOn\r\n        this.numberOfLights = numberOfLights\r\n    }\r\n    drawLight(ctx) {\r\n        if (this.turnedOn) {\r\n            ctx.beginPath()\r\n            //top left\r\n            ctx.moveTo(this.x + this.offset, this.y + this.height)\r\n            //bottom left\r\n            if (this.id == 0) {\r\n                ctx.lineTo(this.x - this.lightWidth, canvas.height - 65)\r\n                ctx.lineTo(this.x - this.lightWidth - this.perspective, canvas.height)\r\n            } else {\r\n                ctx.lineTo(this.x - this.lightWidth, canvas.height)\r\n            }\r\n            //bottom right\r\n            if (this.id == this.numberOfLights - 1) {\r\n                ctx.lineTo(this.x + +this.width + this.lightWidth + this.perspective, canvas.height)\r\n                ctx.lineTo(this.x + this.width + this.lightWidth, canvas.height - 65)\r\n            } else {\r\n                ctx.lineTo(this.x + this.width + this.lightWidth, canvas.height)\r\n            }\r\n            //top right\r\n            ctx.lineTo(this.x + this.width - this.offset, this.y + this.height)\r\n            ctx.closePath()\r\n            ctx.fillStyle = this.color\r\n            ctx.fill()\r\n        }\r\n    }\r\n    drawBody(ctx) {\r\n        ctx.drawImage(this.image, this.x, this.y, this.width, this.height)\r\n    }\r\n    draw(ctx) {\r\n        this.drawBody(ctx)\r\n        this.drawLight(maskCtx)\r\n    }\r\n    onClick() {\r\n        if (!this.isShot) {\r\n            audioPlayer.playAudio('glass')\r\n        }\r\n        this.isShot = true\r\n    }\r\n}\r\n\r\nexport class LightFactory {\r\n    constructor(manifest) {\r\n        this.manifest = manifest\r\n    }\r\n\r\n    createLights(numberOfLights, delay) {\r\n        const { width, height, image, color, lightWidth, lightMargin } = this.manifest\r\n        const lights = []\r\n        const widthSum = width * numberOfLights + lightMargin * (numberOfLights - 1)\r\n        const offset = (canvas.width - widthSum) / 2\r\n\r\n        for (let i = 0; i < numberOfLights; i++) {\r\n            const turnOn = i + delay\r\n            const light = new Light(\r\n                i,\r\n                offset + (width + (i === numberOfLights ? 0 : lightMargin)) * i,\r\n                0,\r\n                width,\r\n                height,\r\n                image,\r\n                color,\r\n                lightWidth,\r\n                turnOn,\r\n                numberOfLights\r\n            )\r\n            lights.push(light)\r\n        }\r\n\r\n        return lights\r\n    }\r\n}\r\n\r\nexport const loadLightFactory = async () => {\r\n    const manifest = await loadManifest('light')\r\n    manifest.image = await loadImage(manifest.mainImageURL)\r\n    return new LightFactory(manifest)\r\n}\r\n","export class Timer {\r\n    constructor() {\r\n        this.startTime = 0\r\n        this.timeElapsed = 0\r\n    }\r\n    start() {\r\n        this.startTime = new Date()\r\n    }\r\n    logTimeElapsed() {\r\n        let timeDiff = (new Date() - this.startTime) / 1000\r\n        let seconds = Math.round(timeDiff)\r\n        if (this.timeElapsed != seconds) {\r\n            this.timeElapsed = seconds\r\n            //console.log(this.timeElapsed)\r\n        }\r\n    }\r\n    getTimeElapsed() {\r\n        return this.timeElapsed\r\n    }\r\n}\r\n","export * from './character'\r\nexport * from './scene'\r\nexport * from './spider'\r\nexport * from './plant'\r\nexport * from './light'\r\nexport * from './loaders'\r\nexport * from './timer'\r\n","export const checkTarget = ({ clientX, clientY }, targets, callback) => {\r\n    callback(\r\n        targets.find(\r\n            target =>\r\n                !target.isShot &&\r\n                clientX > target.x &&\r\n                clientX < target.x + target.width &&\r\n                clientY > target.y &&\r\n                clientY < target.y + target.height\r\n        )\r\n    )\r\n}\r\n","import { ctx, canvas, mask, maskCtx } from '/src/shared/canvas'\r\nimport { loadCharacter, loadScene, loadLightFactory, loadSpiderFactory, loadPlantFactory, Timer } from './classes'\r\nimport { randomIntFromRange } from '/src/shared/helpers'\r\nimport { showGameOver, updateLevel, hideLoadingScreen, updateScore } from '/src/shared/UI'\r\nimport { audioPlayer } from './AudioPlayer'\r\n\r\nimport { checkTarget } from '/src/clickHandler'\r\nimport { updateStreak } from '/src/shared/UI'\r\n\r\nconst defaultState = {\r\n    seedsPlanted: 0,\r\n    seedsShown: false,\r\n    spidersKilled: 0,\r\n    spidersKilledTotal: 0,\r\n    level: -1,\r\n    currentLevel: -1,\r\n    gameOver: false,\r\n    levelUpdated: false,\r\n    score: 0,\r\n    streak: 0,\r\n    biggestStreak: 0,\r\n    shouldRestart: false\r\n}\r\n\r\nconst defaultDifficulty = 'NORMAL'\r\n\r\nexport const GameLoop = async config => {\r\n    window.game = {\r\n        config: config,\r\n        state: JSON.parse(JSON.stringify(defaultState)),\r\n        difficulty: defaultDifficulty,\r\n        levels: config.levels[defaultDifficulty]\r\n    }\r\n\r\n    let timer = new Timer()\r\n    const character = await loadCharacter()\r\n    const scene = await loadScene()\r\n    const plantFactory = await loadPlantFactory()\r\n    const lightFactory = await loadLightFactory()\r\n    const spiderFactory = await loadSpiderFactory()\r\n    await audioPlayer.loadAllSounds()\r\n\r\n    audioPlayer.playMusic('music')\r\n\r\n    let plants = plantFactory.createPlants(config.settings.plants.numberOfPots)\r\n    let lamps = lightFactory.createLights(config.settings.lights.numberOfLights, config.timing.startLights)\r\n    let spiders = []\r\n\r\n    canvas.addEventListener('mousedown', e => {\r\n        checkTarget(e, [...spiders], entity => {\r\n            if (entity) entity.onClick()\r\n            else {\r\n                window.game.state.streak = 0\r\n            }\r\n            updateScore()\r\n            updateStreak(character.streak)\r\n        })\r\n        checkTarget(e, [...lamps, ...plants], entity => {\r\n            if (entity) entity.onClick()\r\n        })\r\n    })\r\n\r\n    const nextLevel = () => {\r\n        window.game.state.currentLevel = window.game.state.level\r\n        window.game.state.levelUpdated = false\r\n        window.game.state.spidersKilled = 0\r\n        spiders = []\r\n    }\r\n\r\n    timer.start()\r\n\r\n    // forcing loading screen to see the amazingness\r\n    //setTimeout(() => hideLoadingScreen(), 2000)\r\n    hideLoadingScreen()\r\n\r\n    const gameLoop = () => {\r\n        if (window.game.state.paused) return window.requestAnimationFrame(gameLoop)\r\n        ctx.globalCompositeOperation = 'normal'\r\n\r\n        scene.draw(ctx)\r\n\r\n        character.move()\r\n\r\n        spiders.forEach(spider => {\r\n            spider.draw(ctx)\r\n        })\r\n\r\n        if (!window.game.state.levelUpdated) {\r\n            window.game.state.levelUpdated = true\r\n            updateLevel()\r\n        }\r\n\r\n        if (!window.game.state.seedsShown) {\r\n            if (config.timing.showSeeds <= timer.getTimeElapsed()) {\r\n                window.game.state.level = 0\r\n                window.game.state.seedsShown = true\r\n                updateLevel()\r\n            }\r\n        }\r\n\r\n        if (window.game.state.level === 0 && window.game.state.currentLevel !== window.game.state.level) {\r\n            if (window.game.state.seedsPlanted == plants.length) {\r\n                if (spiders.length == 0) {\r\n                    spiders = spiderFactory.createSpiders(window.game.levels[0].numberOfSpiders, character, plants)\r\n                }\r\n            }\r\n            if (window.game.state.seedsShown) {\r\n                plants.forEach(plant => {\r\n                    if (plant.showSeed) {\r\n                        plant.showSeedButton()\r\n                        plant.showSeed = false\r\n                    }\r\n                })\r\n            }\r\n        } else if (window.game.state.level === 1 && window.game.state.currentLevel !== window.game.state.level) {\r\n            setTimeout(() => {\r\n                spiders = spiderFactory.createSpiders(window.game.levels[1].numberOfSpiders, character, plants)\r\n            }, 3000)\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n            window.game.plants = plants\r\n        } else if (window.game.state.level === 2 && window.game.state.currentLevel !== window.game.state.level) {\r\n            setTimeout(() => {\r\n                spiders = spiderFactory.createSpiders(window.game.levels[2].numberOfSpiders, character, plants)\r\n            }, 3000)\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n        } else if (window.game.state.level === 3 && window.game.state.currentLevel !== window.game.state.level) {\r\n            nextLevel()\r\n            plants.forEach(plant => {\r\n                plant.grow()\r\n            })\r\n            spiders = spiderFactory.createSpiders(window.game.levels[3].numberOfSpiders, character, plants)\r\n        } else if (window.game.state.level === 4 && window.game.state.currentLevel !== window.game.state.level) {\r\n            nextLevel()\r\n            window.game.state.gameOver = true\r\n        }\r\n\r\n        plants.forEach(plant => {\r\n            plant.draw(ctx)\r\n        })\r\n\r\n        character.draw(ctx)\r\n\r\n        // drawing a black mask over the whole screen\r\n        maskCtx.fillStyle = 'rgb(68, 68, 68)'\r\n        //maskCtx.fillStyle = \"rgb(45, 45, 45)\";\r\n        maskCtx.fillRect(0, 0, mask.width, mask.height)\r\n\r\n        character.drawFlash(maskCtx)\r\n        // adding \"white\" light onto the mask\r\n        lamps.forEach(lamp => {\r\n            if (!lamp.isShot) {\r\n                if (!lamp.turnedOn && lamp.turnOn <= timer.getTimeElapsed()) {\r\n                    lamp.turnedOn = true\r\n                }\r\n                lamp.drawBody(ctx)\r\n                lamp.drawLight(maskCtx)\r\n            } else {\r\n                lamp.drawBody(ctx)\r\n            }\r\n        })\r\n\r\n        // multiply the mask with the underlying canvas\r\n        ctx.globalCompositeOperation = 'multiply'\r\n        ctx.drawImage(mask, 0, 0)\r\n        timer.logTimeElapsed()\r\n\r\n        if (!window.game.state.gameOver && !window.game.state.shouldRestart) {\r\n            window.requestAnimationFrame(gameLoop)\r\n        } else if (window.game.state.shouldRestart) {\r\n            // restart level\r\n            window.game.state = JSON.parse(JSON.stringify(defaultState))\r\n            spiders = []\r\n            document.querySelectorAll(`.seedButton[data-id]`).forEach(el => {\r\n                el.outerHTML = ''\r\n            })\r\n            document.querySelector('#gameOverScreen .win').classList.add('hidden')\r\n            document.querySelector('#gameOverScreen .lost').classList.add('hidden')\r\n            plants = plantFactory.createPlants(config.settings.plants.numberOfPots)\r\n            lamps = lightFactory.createLights(config.settings.lights.numberOfLights, config.timing.startLights)\r\n            window.game.levels = window.game.config.levels[window.game.difficulty]\r\n            window.game.state.streak = 0\r\n            updateStreak()\r\n            window.game.state.shouldRestart = false\r\n\r\n            window.requestAnimationFrame(gameLoop)\r\n        } else {\r\n            window.game.plants = plants\r\n            showGameOver()\r\n            window.game.state.paused = true\r\n            window.requestAnimationFrame(gameLoop)\r\n        }\r\n    }\r\n\r\n    return () => {\r\n        //setInterval(gameLoop, 1000 / 60)\r\n        window.requestAnimationFrame(gameLoop)\r\n    }\r\n}\r\n","module.exports={name:\"Plants and Spiders\",settings:{plants:{numberOfPots:3},lights:{numberOfLights:3},spiders:{EASY:{speed:.7},NORMAL:{speed:1.1},HARD:{speed:1.5}}},timing:{showSeeds:5,startLights:2,delayBetweenLights:1},levels:{EASY:[{numberOfSpiders:7},{numberOfSpiders:12},{numberOfSpiders:17},{numberOfSpiders:20}],NORMAL:[{numberOfSpiders:15},{numberOfSpiders:20},{numberOfSpiders:22},{numberOfSpiders:25}],HARD:[{numberOfSpiders:20},{numberOfSpiders:25},{numberOfSpiders:30},{numberOfSpiders:35}]}};","import { GameLoop } from './gameLoop'\r\nimport config from '/static/manifests/gameConfig.json'\r\nimport './styles/style.scss'\r\n\r\nconst titleScreen = document.querySelector('#titleScreen')\r\nconst tutorialScreen = document.querySelector('#tutorialScreen')\r\ntitleScreen.addEventListener('click', () => {\r\n    titleScreen.classList.add('hidden')\r\n\r\n    tutorialScreen.addEventListener('click', () => {\r\n        tutorialScreen.classList.add('hidden')\r\n\r\n        GameLoop(config).then(startGame => {\r\n            console.log('All systems are go!')\r\n            startGame()\r\n        })\r\n    })\r\n})\r\n\r\n/*features:\r\n- walk up to a plant to grow\r\n- shadows undercharacters\r\n- \r\n*/\r\n\r\n/* \r\n    GAME IDEA:\r\n    - player starts with planting plants\r\n    - spiders are coming towards your plants and want to eat them\r\n    - protect plants against spiders by shooting them\r\n    - plants grow every round\r\n    - spider touching a plant will cause the plant losing one growth cycle thus becoming smaller\r\n    - there will be more spiders and they will be faster or smaller each round (making them harder to hit)\r\n    - each spider picks one of the plants to attack at the beginning of his journey\r\n    - you get points subtracted every time you miss a shot\r\n    - collect plants at the end after 4 rounds, your score depends on how much of your plants is left\r\n    - best achievable score is when all plants are fully grown after 4 rounds and you have missed no shots\r\n*/\r\n"]}